import{u as B}from"./use-quasar.414eeb3f.js";import{u as R,a as F}from"./quizStore.de5eab0d.js";import{bu as O,r as h,aF as x,k as v,o as L,a4 as l,X as m,a9 as q,Y as k,$ as w,q as d,a7 as o,a1 as r,F as V,aa as G}from"./index.037f850d.js";import"./QSpinnerDots.6c974946.js";import"./QItem.a6e550b6.js";import"./QList.80fe3cd0.js";import"./QBanner.958da182.js";import"./CustomImage.fa404383.js";import{_ as E}from"./plugin-vue_export-helper.21dcd24c.js";import"./QImg.c60a9877.js";/* empty css                                                                           */import{G as M}from"./GeneralQuestion.6755875f.js";/* empty css                                                                */import{Q as P,T as j,B as U}from"./BackToTopQuiz.9a05dbf2.js";import{T as J}from"./TestFilter.49414040.js";import{Q as D}from"./QuizOverview.a2be5ae6.js";import"./NumericQuestion.d7b59b0a.js";import"./QSelect.70047d12.js";import"./rtl.ad3ba425.js";import"./selection.b5503321.js";import"./format.8ac60962.js";import"./QLinearProgress.f467e272.js";import"./QExpansionItem.da0e08ff.js";import"./QTooltip.9f64b4d0.js";import"./QPageSticky.881935b1.js";import"./QForm.e3b755fa.js";import"./ClosePopup.f7b4fda5.js";const W={name:"QuizPageNew",components:{GeneralQuestion:M,QuizResult:P,TestFilter:J,TestTimer:j,QuizOverview:D,BackToTopQuiz:U},setup(){const _=B(),n=R(),b=F(),e=O(),u=h(null),s=h({}),f=h(null),{allQuiz:Q}=x(e),c=v(()=>n.formattedQuiz.length>0?n.formattedQuiz.map((t,i)=>({...t,questionNum:i+1,selectedAnswer:h(null)})):[]),S=async t=>{var y,N;u.value=t;let i={};i.courseCode=u.value.classInfo.courseCode,i.levelIndex=u.value.classInfo.levelIndex,i.fullLevelCode=u.value.classInfo.fullLevelCode,i.fullQuizCode=`levelQuiz-${u.value.classInfo.fullCode}`,n.updateFilter(i);let I=(N=(y=Q.value)==null?void 0:y.levelQuiz)==null?void 0:N[i.fullQuizCode];console.log(I),await n.fetchQuizById(I),n.startQuiz()},T=v(()=>c.value.every(t=>s.value&&s.value[t.questionNum]!==null&&s.value[t.questionNum]!==void 0)),p=v(()=>Object.keys(s.value||{}).length),g=v(()=>c.value.length),a=t=>{s.value||(s.value={}),s.value[t.questionNum]=t,console.log("Selected answer:",t),console.log("Current Quiz Result:",s.value)},A=async()=>{if(console.log("Trying submitting the quiz"),z.value.length>0){`${z.value.join(", ")}`,_.dialog({title:"Ch\u01B0a ho\xE0n th\xE0nh b\xE0i ki\u1EC3m tra",message:`B\u1EA1n ch\u01B0a tr\u1EA3 l\u1EDDi c\xE1c c\xE2u h\u1ECFi s\u1ED1: ${z.value.join(", ")}.
          Vui l\xF2ng ki\u1EC3m tra v\xE0 tr\u1EA3 l\u1EDDi \u0111\u1EA7y \u0111\u1EE7 c\xE1c c\xE2u h\u1ECFi tr\u01B0\u1EDBc khi n\u1ED9p b\xE0i.`,persistent:!0,ok:{label:"\u0110\xE3 hi\u1EC3u",color:"primary"}});return}const t={studentInfo:u.value.studentInfo,classInfo:u.value.classInfo,timestamp:new Date().toISOString(),result:s.value};t.score=n.calculateScore(t.result),console.log(`Score: ${JSON.stringify(t.score)}`),t.statistics=n.calculateStatistics(t),t.testId=n.testId,console.log("Quiz submitted:",JSON.stringify(t)),n.updateQuizResult(t),await n.pushTestResultToFirestore()},C=t=>!t.dayOfWeek||!t.startTime||!t.endTime?"":`${t.dayOfWeek} (${t.startTime} - ${t.endTime})`;L(async()=>{await Promise.all([n.initializeStore(),b.initializeStore(),e.initializeStore()])});const z=v(()=>c.value.filter(t=>!s.value||s.value[t.questionNum]===null||s.value[t.questionNum]===void 0).map(t=>t.questionNum));return{formattedQuestions:c,studentData:u,startQuiz:S,handleSubmitQuiz:A,formatSchedule:C,handleAnswer:a,quizStore:n,areAllQuestionsAnswered:T,numAnsweredQuestion:p,numTotalQuestion:g,notAnsweredQuestionList:z,QuizOverview:D,currentQuestion:f,scrollToQuestion:t=>{f.value=t;const i=document.getElementById(`question-${t}`);i&&i.scrollIntoView({behavior:"smooth",block:"center"})},quizResult:s,allQuiz:Q}}},K={class:"q-pa-xs",ref:"quizResultContent"},X={key:1,class:"quiz-content"},Y={class:"questions-container"},H={class:"student-info q-mb-md q-mt-lg"},Z={class:"row q-col-gutter-md"},$={class:"col-12 col-md-4"},ee={class:"col-12 col-md-8"},te={class:"quiz-test-wrapper"},ne={class:"questions-section q-mt-lg"};function oe(_,n,b,e,u,s){const f=l("TestFilter"),Q=l("QuizOverview"),c=l("TestTimer"),S=l("MultipleChoiceQuestion"),T=l("GeneralQuestion"),p=l("QuizResult"),g=l("BackToTopQuiz");return m(),q("div",K,[e.quizStore.isTestStart?w("",!0):(m(),k(f,{key:0,onStartQuiz:e.startQuiz},null,8,["onStartQuiz"])),e.quizStore.isTestStart&&!e.quizStore.isTestEnd?(m(),q("div",X,[d(Q,{"answered-questions":e.quizResult,"total-questions":e.numTotalQuestion,"current-question":e.currentQuestion,"can-submit":e.numAnsweredQuestion===e.numTotalQuestion,"student-name":e.studentData.studentInfo.name,onSubmitQuiz:e.handleSubmitQuiz,onQuestionSelected:e.scrollToQuestion},null,8,["answered-questions","total-questions","current-question","can-submit","student-name","onSubmitQuiz","onQuestionSelected"]),o("div",Y,[o("div",H,[n[0]||(n[0]=o("div",{class:"text-h6"},"Th\xF4ng tin h\u1ECDc vi\xEAn",-1)),o("div",Z,[o("div",$,[o("div",null,"T\xEAn: "+r(e.studentData.studentInfo.name),1),o("div",null,"M\xE3 h\u1ECDc vi\xEAn: "+r(e.studentData.studentInfo.studentId),1),o("div",null,"Batch: "+r(e.studentData.studentInfo.batch),1)]),o("div",ee,[o("div",null,"Trung t\xE2m: "+r(e.studentData.classInfo.company),1),o("div",null,"Kh\xF3a h\u1ECDc: "+r(e.studentData.classInfo.course),1),o("div",null,"Level: "+r(e.studentData.classInfo.level),1),o("div",null,"L\u1ECBch h\u1ECDc: "+r(e.formatSchedule(e.studentData.classInfo)),1)])])]),d(Q,{"answered-questions":e.quizResult,"total-questions":e.numTotalQuestion,"current-question":e.currentQuestion,"can-submit":e.numAnsweredQuestion===e.numTotalQuestion,"student-name":e.studentData.studentInfo.name,onSubmitQuiz:e.handleSubmitQuiz,onQuestionSelected:e.scrollToQuestion},null,8,["answered-questions","total-questions","current-question","can-submit","student-name","onSubmitQuiz","onQuestionSelected"]),o("div",te,[d(c,{"student-name":e.studentData.studentInfo.name,"time-limit":45,"can-submit":!0,totalQuestionNum:e.numTotalQuestion,"answered-question-num":e.numAnsweredQuestion,onSubmitQuiz:e.handleSubmitQuiz},null,8,["student-name","totalQuestionNum","answered-question-num","onSubmitQuiz"])]),o("div",ne,[(m(!0),q(V,null,G(e.formattedQuestions,a=>(m(),q("div",{key:"ques-"+a.questionNum,class:"q-mb-lg"},[d(S,{questionData:a,questionNumber:a.questionNum,onAnswerSelected:e.handleAnswer},null,8,["questionData","questionNumber","onAnswerSelected"]),d(T,{questionData:a,questionNumber:a.questionNum,"onUpdate:question":_.handleQuestionUpdate,onAnswerSelected:e.handleAnswer},null,8,["questionData","questionNumber","onUpdate:question","onAnswerSelected"])]))),128))])])])):w("",!0),e.quizStore.isTestStart&&e.quizStore.isTestEnd?(m(),k(p,{key:2})):w("",!0),d(g)],512)}var Ce=E(W,[["render",oe],["__scopeId","data-v-96a5e3d0"]]);export{Ce as default};
