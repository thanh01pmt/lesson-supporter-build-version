import{u as D}from"./use-quasar.414eeb3f.js";import{u as N,a as A}from"./quizStore.de5eab0d.js";import{M as B,q as w}from"./MultipleChoiceQuestion.96ab4548.js";import{Q as C,T as R,B as O}from"./BackToTopQuiz.9a05dbf2.js";import{T as x}from"./TestFilter.49414040.js";import{Q as y}from"./QuizOverview.a2be5ae6.js";import{_ as F}from"./plugin-vue_export-helper.21dcd24c.js";import{r as f,k as m,o as L,a4 as r,X as l,a9 as h,Y as k,$ as b,q as d,a7 as n,a1 as u,F as M,aa as V}from"./index.037f850d.js";import"./QSpinnerDots.6c974946.js";import"./QItem.a6e550b6.js";import"./QList.80fe3cd0.js";import"./QBanner.958da182.js";import"./CustomImage.fa404383.js";import"./QImg.c60a9877.js";/* empty css                                                                           */import"./rtl.ad3ba425.js";import"./QLinearProgress.f467e272.js";import"./format.8ac60962.js";import"./QExpansionItem.da0e08ff.js";import"./QTooltip.9f64b4d0.js";import"./QSelect.70047d12.js";import"./selection.b5503321.js";import"./QPageSticky.881935b1.js";import"./QForm.e3b755fa.js";import"./ClosePopup.f7b4fda5.js";const E={name:"QuizPage",components:{MultipleChoiceQuestion:B,QuizResult:C,TestFilter:x,TestTimer:R,QuizOverview:y,BackToTopQuiz:O},setup(){const q=D(),o=N(),g=A(),t=f(null),s=f({}),z=f(null),a=m(()=>o.formattedQuiz.map(e=>({...e,selectedAnswer:f(null)}))),v=e=>{t.value=e;let i={};i.courseCode=t.value.classInfo.courseCode,i.levelIndex=t.value.classInfo.levelIndex,i.fullLevelCode=t.value.classInfo.fullLevelCode,o.updateFilter(i),o.startQuiz()},_=m(()=>a.value.every(e=>s.value&&s.value[e.questionNum]!==null&&s.value[e.questionNum]!==void 0)),S=m(()=>Object.keys(s.value||{}).length),T=m(()=>a.value.length),p=e=>{s.value||(s.value={}),s.value[e.questionNum]=e,console.log("Selected answer:",e),console.log("Current Quiz Result:",s.value)},c=async()=>{if(Q.value.length>0){`${Q.value.join(", ")}`,q.dialog({title:"Ch\u01B0a ho\xE0n th\xE0nh b\xE0i ki\u1EC3m tra",message:`B\u1EA1n ch\u01B0a tr\u1EA3 l\u1EDDi c\xE1c c\xE2u h\u1ECFi s\u1ED1: ${Q.value.join(", ")}.
          Vui l\xF2ng ki\u1EC3m tra v\xE0 tr\u1EA3 l\u1EDDi \u0111\u1EA7y \u0111\u1EE7 c\xE1c c\xE2u h\u1ECFi tr\u01B0\u1EDBc khi n\u1ED9p b\xE0i.`,persistent:!0,ok:{label:"\u0110\xE3 hi\u1EC3u",color:"primary"}});return}const e={studentInfo:t.value.studentInfo,classInfo:t.value.classInfo,timestamp:new Date().toISOString(),result:s.value};e.score=o.calculateScore(e.result),console.log(`Score: ${JSON.stringify(e.score)}`),e.statistics=o.calculateStatistics(e),e.testId=o.testId,console.log("Quiz submitted:",JSON.stringify(e)),o.updateQuizResult(e),await o.pushTestResultToFirestore()},I=e=>!e.dayOfWeek||!e.startTime||!e.endTime?"":`${e.dayOfWeek} (${e.startTime} - ${e.endTime})`;L(async()=>{await Promise.all([o.initializeStore(),g.initializeStore()]),Array.isArray(w.questions)&&(o.formattedQuiz=w.questions)});const Q=m(()=>a.value.filter(e=>!s.value||s.value[e.questionNum]===null||s.value[e.questionNum]===void 0).map(e=>e.questionNum));return{formattedQuestions:a,studentData:t,startQuiz:v,handleSubmitQuiz:c,formatSchedule:I,handleAnswer:p,quizStore:o,areAllQuestionsAnswered:_,numAnsweredQuestion:S,numTotalQuestion:T,notAnsweredQuestionList:Q,$q:q,QuizOverview:y,currentQuestion:z,scrollToQuestion:e=>{z.value=e;const i=document.getElementById(`question-${e}`);i&&i.scrollIntoView({behavior:"smooth",block:"center"})},quizResult:s}}},P={class:"q-pa-xs",ref:"quizResultContent"},j={key:1,class:"quiz-content"},J={class:"questions-container"},W={class:"student-info q-mb-md q-mt-lg"},K={class:"row q-col-gutter-md"},X={class:"col-12 col-md-4"},Y={class:"col-12 col-md-8"},G={class:"quiz-test-wrapper"},H={class:"questions-section q-mt-lg"};function U(q,o,g,t,s,z){const a=r("TestFilter"),v=r("QuizOverview"),_=r("TestTimer"),S=r("MultipleChoiceQuestion"),T=r("QuizResult"),p=r("BackToTopQuiz");return l(),h("div",P,[t.quizStore.isTestStart?b("",!0):(l(),k(a,{key:0,onStartQuiz:t.startQuiz},null,8,["onStartQuiz"])),t.quizStore.isTestStart&&!t.quizStore.isTestEnd?(l(),h("div",j,[d(v,{"answered-questions":t.quizResult,"total-questions":t.numTotalQuestion,"current-question":t.currentQuestion,"can-submit":t.numAnsweredQuestion===t.numTotalQuestion,"student-name":t.studentData.studentInfo.name,onSubmitQuiz:t.handleSubmitQuiz,onQuestionSelected:t.scrollToQuestion},null,8,["answered-questions","total-questions","current-question","can-submit","student-name","onSubmitQuiz","onQuestionSelected"]),n("div",J,[n("div",W,[o[0]||(o[0]=n("div",{class:"text-h6"},"Th\xF4ng tin h\u1ECDc vi\xEAn",-1)),n("div",K,[n("div",X,[n("div",null,"T\xEAn: "+u(t.studentData.studentInfo.name),1),n("div",null,"M\xE3 h\u1ECDc vi\xEAn: "+u(t.studentData.studentInfo.studentId),1),n("div",null,"Batch: "+u(t.studentData.studentInfo.batch),1)]),n("div",Y,[n("div",null,"Trung t\xE2m: "+u(t.studentData.classInfo.company),1),n("div",null,"Kh\xF3a h\u1ECDc: "+u(t.studentData.classInfo.course),1),n("div",null,"Level: "+u(t.studentData.classInfo.level),1),n("div",null,"L\u1ECBch h\u1ECDc: "+u(t.formatSchedule(t.studentData.classInfo)),1)])])]),d(v,{"answered-questions":t.quizResult,"total-questions":t.numTotalQuestion,"current-question":t.currentQuestion,"can-submit":t.numAnsweredQuestion===t.numTotalQuestion,"student-name":t.studentData.studentInfo.name,onSubmitQuiz:t.handleSubmitQuiz,onQuestionSelected:t.scrollToQuestion},null,8,["answered-questions","total-questions","current-question","can-submit","student-name","onSubmitQuiz","onQuestionSelected"]),n("div",G,[d(_,{"student-name":t.studentData.studentInfo.name,"time-limit":45,"can-submit":!0,totalQuestionNum:t.numTotalQuestion,"answered-question-num":t.numAnsweredQuestion,onSubmitQuiz:t.handleSubmitQuiz},null,8,["student-name","totalQuestionNum","answered-question-num","onSubmitQuiz"])]),n("div",H,[(l(!0),h(M,null,V(t.formattedQuestions,c=>(l(),h("div",{key:"orig-"+c.questionNum,class:"q-mb-lg"},[d(S,{questionData:c,questionNumber:c.questionNum,onAnswerSelected:t.handleAnswer},null,8,["questionData","questionNumber","onAnswerSelected"])]))),128))])])])):b("",!0),t.quizStore.isTestStart&&t.quizStore.isTestEnd?(l(),k(T,{key:2})):b("",!0),d(p)],512)}var gt=F(E,[["render",U],["__scopeId","data-v-e40fd1ba"]]);export{gt as default};
