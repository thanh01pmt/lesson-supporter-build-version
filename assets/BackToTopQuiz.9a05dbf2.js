import{aR as A,y as K,aS as W,k as g,i as S,aT as Y,p as G,r as w,a8 as p,X as v,a9 as x,a7 as t,q as a,Z as o,a6 as L,ae as q,a1 as i,a0 as k,F as T,aa as C,ad as $,Y as D,_ as H,$ as X,cd as N,bY as U,h as Z,o as F,m as V,a5 as J,cb as ee,L as te,aO as se}from"./index.037f850d.js";import{Q as ae}from"./QSpinnerDots.6c974946.js";import{Q as I}from"./rtl.ad3ba425.js";import{Q as oe}from"./QLinearProgress.f467e272.js";import{b as re}from"./format.8ac60962.js";import{a as ie,b as P,Q as ne}from"./QItem.a6e550b6.js";import{Q as le}from"./QList.80fe3cd0.js";import{Q as ce}from"./QExpansionItem.da0e08ff.js";import{u as ue}from"./quizStore.de5eab0d.js";import{_ as B}from"./plugin-vue_export-helper.21dcd24c.js";import{Q as de}from"./QTooltip.9f64b4d0.js";import{Q as me}from"./QPageSticky.881935b1.js";const ve={...A,min:{type:Number,default:0},max:{type:Number,default:100},color:String,centerColor:String,trackColor:String,fontSize:String,rounded:Boolean,thickness:{type:Number,default:.2,validator:e=>e>=0&&e<=1},angle:{type:Number,default:0},showValue:Boolean,reverse:Boolean,instantFeedback:Boolean},R=50,M=2*R,E=M*Math.PI,_e=Math.round(E*1e3)/1e3;var fe=K({name:"QCircularProgress",props:{...ve,value:{type:Number,default:0},animationSpeed:{type:[String,Number],default:600},indeterminate:Boolean},setup(e,{slots:n}){const{proxy:{$q:r}}=G(),d=W(e),_=g(()=>{const l=(r.lang.rtl===!0?-1:1)*e.angle;return{transform:e.reverse!==(r.lang.rtl===!0)?`scale3d(-1, 1, 1) rotate3d(0, 0, 1, ${-90-l}deg)`:`rotate3d(0, 0, 1, ${l-90}deg)`}}),y=g(()=>e.instantFeedback!==!0&&e.indeterminate!==!0?{transition:`stroke-dashoffset ${e.animationSpeed}ms ease 0s, stroke ${e.animationSpeed}ms ease`}:""),m=g(()=>M/(1-e.thickness/2)),z=g(()=>`${m.value/2} ${m.value/2} ${m.value} ${m.value}`),u=g(()=>re(e.value,e.min,e.max)),c=g(()=>e.max-e.min),s=g(()=>e.thickness/2*m.value),f=g(()=>{const l=(e.max-u.value)/c.value,h=e.rounded===!0&&u.value<e.max&&l<.25?s.value/2*(1-l/.25):0;return E*l+h});function b({thickness:l,offset:h,color:Q,cls:O,rounded:j}){return S("circle",{class:"q-circular-progress__"+O+(Q!==void 0?` text-${Q}`:""),style:y.value,fill:"transparent",stroke:"currentColor","stroke-width":l,"stroke-dasharray":_e,"stroke-dashoffset":h,"stroke-linecap":j,cx:m.value,cy:m.value,r:R})}return()=>{const l=[];e.centerColor!==void 0&&e.centerColor!=="transparent"&&l.push(S("circle",{class:`q-circular-progress__center text-${e.centerColor}`,fill:"currentColor",r:R-s.value/2,cx:m.value,cy:m.value})),e.trackColor!==void 0&&e.trackColor!=="transparent"&&l.push(b({cls:"track",thickness:s.value,offset:0,color:e.trackColor})),l.push(b({cls:"circle",thickness:s.value,offset:f.value,color:e.color,rounded:e.rounded===!0?"round":void 0}));const h=[S("svg",{class:"q-circular-progress__svg",style:_.value,viewBox:z.value,"aria-hidden":"true"},l)];return e.showValue===!0&&h.push(S("div",{class:"q-circular-progress__text absolute-full row flex-center content-center",style:{fontSize:e.fontSize}},n.default!==void 0?n.default():[S("div",u.value)])),S("div",{class:`q-circular-progress q-circular-progress--${e.indeterminate===!0?"in":""}determinate`,style:d.value,role:"progressbar","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.indeterminate===!0?void 0:u.value},Y(n.internal,h))}}});const ge={key:0},he={class:"header-actions q-mb-md"},pe={class:"row items-center q-col-gutter-md"},xe={class:"col-12 col-md-8"},ye={class:"text-h5 q-mb-sm"},be={class:"row q-col-gutter-md"},qe={class:"col-auto"},ke={class:"col-auto"},we={class:"col-12 col-md-4 text-right"},Se={class:"text-subtitle1"},ze={class:"row items-center justify-center"},Qe={class:"col-12 text-center"},Te={class:"row items-center justify-center q-gutter-x-md"},Ce={class:"text-h4 text-primary"},$e={class:"text-h5 text-grey-7"},Ne={class:"analysis-section avoid-break"},Pe={class:"row q-col-gutter-none"},Re={class:"row justify-between items-center q-mb-xs"},Be={class:"text-subtitle1"},Ie={class:"text-caption text-grey-7"},Le={class:"absolute-full flex flex-center"},De={class:"text-white text-subtitle2"},Fe={class:"row q-col-gutter-md"},Ve={class:"text-subtitle1 q-mb-sm"},Me={class:"text-caption q-mt-sm text-grey-7"},Ee={class:"row q-col-gutter-md"},Oe={__name:"QuizResult",setup(e){const n=w(!1),r=ue(),d=w(null),_=g(()=>r.quizResult.statistics),y=u=>new Date(u).toLocaleString(),m=u=>u>=80?"positive":u>=50?"warning":"negative",z=async()=>{var u;if(!d.value){N.create({type:"negative",message:"Kh\xF4ng th\u1EC3 t\u1EA1o PDF. Vui l\xF2ng th\u1EED l\u1EA1i!",position:"top"});return}n.value=!0;try{const c=(await U(()=>import("./html2pdf.acea60e2.js").then(function(b){return b.h}),["assets/html2pdf.acea60e2.js","assets/index.037f850d.js","assets/index.edc6ebf1.css"])).default,s=d.value;s.classList.add("printing"),await new Promise(b=>setTimeout(b,100));const f={margin:2,filename:`BaoCaoKetQuaKiemTra_${r.quizResult.studentInfo.name}_${new Date().toLocaleDateString("vi-VN")}.pdf`,image:{type:"jpeg",quality:1},html2canvas:{scale:1,useCORS:!0,logging:!1,letterRendering:!0,allowTaint:!0},jsPDF:{unit:"mm",format:"a4",orientation:"portrait"}};await c().set(f).from(s).save(),N.create({type:"positive",message:"Xu\u1EA5t PDF th\xE0nh c\xF4ng!",position:"top"})}catch(c){console.error("L\u1ED7i khi t\u1EA1o PDF:",c),N.create({type:"negative",message:"C\xF3 l\u1ED7i x\u1EA3y ra khi xu\u1EA5t PDF. Vui l\xF2ng th\u1EED l\u1EA1i!",position:"top"})}finally{(u=d.value)==null||u.classList.remove("printing"),n.value=!1}};return(u,c)=>p(r).quizResult&&p(r).isTestEnd?(v(),x("div",ge,[t("div",he,[a(L,{color:"primary",icon:"print",label:"In k\u1EBFt qu\u1EA3",onClick:z,loading:n.value,disable:n.value,class:"print-btn"},{loading:o(()=>[a(ae)]),_:1},8,["loading","disable"])]),t("div",{ref_key:"quizResultContent",ref:d,class:"quiz-result-container"},[a($,{class:"result-card",flat:"",bordered:""},{default:o(()=>[a(q,{class:"bg-primary text-white"},{default:o(()=>[t("div",pe,[t("div",xe,[t("div",ye,i(p(r).quizResult.studentInfo.name),1),t("div",be,[t("div",qe,[a(I,{outline:"",class:"bg-white text-primary"},{default:o(()=>[k(" M\xE3 HS: "+i(p(r).quizResult.studentInfo.studentId),1)]),_:1})]),t("div",ke,[a(I,{outline:"",class:"bg-white text-primary"},{default:o(()=>[k(" L\u1EDBp: "+i(p(r).quizResult.classInfo.course)+" - "+i(p(r).quizResult.classInfo.level),1)]),_:1})])])]),t("div",we,[c[0]||(c[0]=t("div",{class:"text-caption q-mb-sm"},"Ng\xE0y ki\u1EC3m tra",-1)),t("div",Se,i(y(p(r).quizResult.timestamp)),1)])])]),_:1}),a(q,{class:"score-overview q-pa-xs"},{default:o(()=>[t("div",ze,[t("div",Qe,[t("div",Te,[t("div",Ce,i(p(r).quizResult.score.percentage.toFixed(1))+"% ",1),t("div",$e,i(p(r).quizResult.score.correctCount)+"/"+i(p(r).quizResult.score.totalQuestions)+" c\xE2u \u0111\xFAng ",1)])])])]),_:1}),t("div",Ne,[a(q,null,{default:o(()=>[c[1]||(c[1]=t("div",{class:"text-h6 q-mb-xs q-ml-md"},"Ph\xE2n t\xEDch theo ki\u1EBFn th\u1EE9c",-1)),t("div",Pe,[(v(!0),x(T,null,C(_.value.conceptPerformance,s=>(v(),x("div",{key:s.conceptName,class:"col-12 col-md-6"},[a($,{flat:"",class:"concept-card"},{default:o(()=>[a(q,null,{default:o(()=>[t("div",Re,[t("div",Be,i(s.conceptName),1),t("div",Ie,i(s.correctAnswers)+"/"+i(s.totalQuestions)+" c\xE2u \u0111\xFAng ",1)]),a(oe,{value:s.percentage/100,color:m(s.percentage),size:"20px",rounded:""},{default:o(()=>[t("div",Le,[t("span",De,i(s.percentage.toFixed(0))+"% ",1)])]),_:2},1032,["value","color"])]),_:2},1024)]),_:2},1024)]))),128))])]),_:1}),a(q,{class:"q-pt-xs"},{default:o(()=>[c[2]||(c[2]=t("div",{class:"text-h6 q-mb-xs"},"Ph\xE2n t\xEDch theo thang \u0111o Bloom ",-1)),t("div",Fe,[(v(!0),x(T,null,C(_.value.bloomPerformance,s=>(v(),x("div",{key:s.level,class:"col-12 col-md-4"},[a($,{bordered:"",flat:"",class:"bloom-card"},{default:o(()=>[a(q,null,{default:o(()=>[t("div",Ve,i(s.level),1),a(fe,{"show-value":"",value:s.percentage,size:"100px",color:s.percentage>=70?"positive":"negative","track-color":"grey-3"},{default:o(()=>[k(i(s.percentage.toFixed(0))+"% ",1)]),_:2},1032,["value","color"]),t("div",Me,i(s.correctAnswers)+"/"+i(s.totalQuestions)+" c\xE2u \u0111\xFAng ",1)]),_:2},1024)]),_:2},1024)]))),128))])]),_:1})]),a(q,{class:"page-break-before knowledge-improvement"},{default:o(()=>[c[4]||(c[4]=t("div",{class:"text-h6 q-mb-md"},"Ki\u1EBFn th\u1EE9c c\u1EA7n \xF4n t\u1EADp",-1)),t("div",Ee,[(v(!0),x(T,null,C(_.value.conceptsToImprove,s=>(v(),x("div",{key:s.conceptName,class:"col-12 col-md-6"},[a(ce,{label:s.conceptName,caption:`M\u1EE9c ch\xEDnh x\xE1c: ${s.currentPerformance.toFixed(1)}%`,"header-class":"bg-grey-2 text-h6","expand-icon-class":"text-primary","default-opened":""},{default:o(()=>[a($,null,{default:o(()=>[a(q,{class:"q-px-none"},{default:o(()=>[a(le,{separator:""},{default:o(()=>[(v(!0),x(T,null,C(s.weakPoints,f=>(v(),D(ne,{key:f.questionNum},{default:o(()=>[a(ie,null,{default:o(()=>[a(P,{class:"text-subtitle1 text-weight-medium q-pb-sm"},{default:o(()=>[k(" C\xE2u "+i(f.questionNum),1)]),_:2},1024),a(P,{class:"text-body2 q-pb-sm"},{default:o(()=>[k(i(f.question),1)]),_:2},1024),a(P,{class:"text-body2 text-primary"},{default:o(()=>[a(H,{name:"lightbulb",size:"sm",class:"q-mr-sm"}),c[3]||(c[3]=t("span",{class:"text-weight-medium"},"G\u1EE3i \xFD:",-1)),k(" "+i(f.explanation),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["label","caption"])]))),128))])]),_:1})]),_:1})],512)])):X("",!0)}};var dt=B(Oe,[["__scopeId","data-v-43dba756"]]);const je=Z({name:"TestTimer",props:{studentName:{type:String,required:!0},timeLimit:{type:Number,default:45},canSubmit:{type:Boolean,default:!1},totalQuestionNum:{type:Number,required:!0},answeredQuestionNum:{type:Number,required:!0}},emits:["submit-quiz"],setup(e,{emit:n}){const r=w(e.timeLimit*60),d=w(!1),_=w("");let y=null,m=w(!1);const z=g(()=>r.value<=300),u=l=>{const h=Math.floor(l/60),Q=l%60;return`${h}:${Q.toString().padStart(2,"0")}`},c=()=>{y=setInterval(()=>{r.value>0?r.value--:f()},1e3)},s=()=>{d.value=!0,_.value=""},f=()=>{(_.value===e.studentName||r.value===0)&&(n("submit-quiz"),d.value=!1)},b=g(()=>{const l=2*Math.PI*56,h=r.value/(e.timeLimit*60);return l-h*l});return F(()=>{c()}),V(()=>{y&&clearInterval(y)}),{timeRemaining:r,submitDialog:d,confirmName:_,timeWarning:z,formatTime:u,showSubmitDialog:s,handleSubmit:f,isHovered:m,progressOffset:b}}}),Ae={class:"quiz-test"},Ke={class:"clock-container"},We={class:"clock-circle"},Ye={class:"time-display"},Ge={class:"time-text"},He={class:"progress-ring",width:"120",height:"120"};function Xe(e,n,r,d,_,y){return v(),x("div",Ae,[t("div",Ke,[t("div",We,[t("div",Ye,[t("div",Ge,i(e.formatTime(e.timeRemaining)),1),n[0]||(n[0]=t("div",{class:"time-label"},"remaining",-1))]),(v(),x("svg",He,[t("circle",{class:J(["progress-ring__circle",{warning:e.timeWarning}]),"stroke-width":"4",fill:"transparent",r:"56",cx:"60",cy:"60",style:ee({strokeDashoffset:e.progressOffset})},null,6)]))])])])}var mt=B(je,[["render",Xe],["__scopeId","data-v-55dde664"]]);const Ue={name:"BackToTopQuiz",setup(){const e=w(!1),n=()=>{e.value=window.pageYOffset>300};return F(()=>{window.addEventListener("scroll",n)}),V(()=>{window.removeEventListener("scroll",n)}),{showBackToTop:e,scrollToTop:()=>{window.scrollTo({top:0,behavior:"smooth"})}}}};function Ze(e,n,r,d,_,y){return v(),D(me,{position:"bottom-right",offset:[30,30]},{default:o(()=>[te(a(L,{round:"",color:"primary",icon:"keyboard_arrow_up",size:"lg",onClick:d.scrollToTop,class:"back-to-top-btn"},{default:o(()=>[a(de,null,{default:o(()=>n[0]||(n[0]=[k("L\xEAn \u0111\u1EA7u trang")])),_:1})]),_:1},8,["onClick"]),[[se,d.showBackToTop]])]),_:1})}var vt=B(Ue,[["render",Ze],["__scopeId","data-v-23d6218c"]]);export{vt as B,dt as Q,mt as T};
