import{y as lt,E as ot,H as it,r as L,bo as Pt,k as w,w as re,i as _,p as at,x as Be,aV as rt,aP as st,_ as qe,bx as Ft,ak as Ve,L as Ge,aO as Dt,bE as dt,ap as St,z as Et,aw as It,av as ht,a6 as ee,bF as Bt,o as Vt,u as Gt,bj as Mt,X as C,a9 as I,Y as te,Z as N,q as y,ae as ge,a7 as Z,F as ve,aa as pe,a0 as Ce,$ as ne,ad as Me,bs as ye,a4 as _e,bG as Ut,br as zt,a1 as ke,bt as Ke,ag as Ct,ac as nt,bH as Ae,U as Tt,bI as Ht,bJ as gt,bK as Kt,aj as Rt,al as Jt,ar as Re,as as Qt,at as je,ax as mt,ay as Je,bL as $t,bM as Xt,bN as Wt,bO as Yt,bP as Le,d as Pe,bQ as Fe,bR as De,bS as Ee}from"./index.037f850d.js";import{b as Zt}from"./format.8ac60962.js";import{c as Qe}from"./selection.b5503321.js";import{Q as en}from"./QBtnToggle.c4c9bb64.js";import{Q as tn}from"./QFile.5371de78.js";import{a as he,Q as Se,b as nn}from"./QItem.a6e550b6.js";import{Q as ct}from"./QList.80fe3cd0.js";import{C as xt}from"./ClosePopup.f7b4fda5.js";import{a as ln}from"./QExpansionItem.da0e08ff.js";import{Q as on,A as an}from"./ajv.fc11b563.js";import{Q as Ue}from"./QTooltip.9f64b4d0.js";import{u as rn,a as sn,b as cn}from"./use-fullscreen.e9e81b6d.js";import{Q as Nt}from"./QSelect.70047d12.js";import{G as wt,Q as un}from"./QSplitter.8a57269e.js";import{u as _t}from"./use-quasar.414eeb3f.js";import{u as dn}from"./googleAIService.c307673a.js";import{m as hn}from"./marked.esm.ee94f6d8.js";import{_ as ze}from"./plugin-vue_export-helper.21dcd24c.js";const gn=["none","strict","leaf","leaf-filtered"];var mn=lt({name:"QTree",props:{...ot,nodes:{type:Array,required:!0},nodeKey:{type:String,required:!0},labelKey:{type:String,default:"label"},childrenKey:{type:String,default:"children"},dense:Boolean,color:String,controlColor:String,textColor:String,selectedColor:String,icon:String,tickStrategy:{type:String,default:"none",validator:e=>gn.includes(e)},ticked:Array,expanded:Array,selected:{},noSelectionUnset:Boolean,defaultExpandAll:Boolean,accordion:Boolean,filter:String,filterMethod:Function,duration:{},noConnectors:Boolean,noTransition:Boolean,noNodesLabel:String,noResultsLabel:String},emits:["update:expanded","update:ticked","update:selected","lazyLoad","afterShow","afterHide"],setup(e,{slots:n,emit:l}){const{proxy:t}=at(),{$q:d}=t,h=it(e,d),c=L({}),v=L(e.ticked||[]),m=L(e.expanded||[]);let f={};Pt(()=>{f={}});const i=w(()=>`q-tree q-tree--${e.dense===!0?"dense":"standard"}`+(e.noConnectors===!0?" q-tree--no-connectors":"")+(h.value===!0?" q-tree--dark":"")+(e.color!==void 0?` text-${e.color}`:"")),x=w(()=>e.selected!==void 0),p=w(()=>e.icon||d.iconSet.tree.icon),b=w(()=>e.controlColor||e.color),T=w(()=>e.textColor!==void 0?` text-${e.textColor}`:""),P=w(()=>{const u=e.selectedColor||e.color;return u?` text-${u}`:""}),M=w(()=>e.filterMethod!==void 0?e.filterMethod:(u,g)=>{const s=g.toLowerCase();return u[e.labelKey]&&u[e.labelKey].toLowerCase().indexOf(s)!==-1}),F=w(()=>{const u={},g=(s,j)=>{const o=s.tickStrategy||(j?j.tickStrategy:e.tickStrategy),r=s[e.nodeKey],S=s[e.childrenKey]&&Array.isArray(s[e.childrenKey])&&s[e.childrenKey].length!==0,K=s.disabled!==!0&&x.value===!0&&s.selectable!==!1,z=s.disabled!==!0&&s.expandable!==!1,Te=o!=="none",be=o==="strict",Oe=o==="leaf-filtered",xe=o==="leaf"||o==="leaf-filtered";let Ne=s.disabled!==!0&&s.tickable!==!1;xe===!0&&Ne===!0&&j&&j.tickable!==!0&&(Ne=!1);let fe=s.lazy;fe===!0&&c.value[r]!==void 0&&Array.isArray(s[e.childrenKey])===!0&&(fe=c.value[r]);const V={key:r,parent:j,isParent:S,lazy:fe,disabled:s.disabled,link:s.disabled!==!0&&(K===!0||z===!0&&(S===!0||fe===!0)),children:[],matchesFilter:e.filter?M.value(s,e.filter):!0,selected:r===e.selected&&K===!0,selectable:K,expanded:S===!0?m.value.includes(r):!1,expandable:z,noTick:s.noTick===!0||be!==!0&&fe&&fe!=="loaded",tickable:Ne,tickStrategy:o,hasTicking:Te,strictTicking:be,leafFilteredTicking:Oe,leafTicking:xe,ticked:be===!0?v.value.includes(r):S===!0?!1:v.value.includes(r)};if(u[r]=V,S===!0&&(V.children=s[e.childrenKey].map(a=>g(a,V)),e.filter&&(V.matchesFilter!==!0?V.matchesFilter=V.children.some(a=>a.matchesFilter):V.noTick!==!0&&V.disabled!==!0&&V.tickable===!0&&Oe===!0&&V.children.every(a=>a.matchesFilter!==!0||a.noTick===!0||a.tickable!==!0)===!0&&(V.tickable=!1)),V.matchesFilter===!0&&(V.noTick!==!0&&be!==!0&&V.children.every(a=>a.noTick)===!0&&(V.noTick=!0),xe))){if(V.ticked=!1,V.indeterminate=V.children.some(a=>a.indeterminate===!0),V.tickable=V.tickable===!0&&V.children.some(a=>a.tickable),V.indeterminate!==!0){const a=V.children.reduce((k,G)=>G.ticked===!0?k+1:k,0);a===V.children.length?V.ticked=!0:a>0&&(V.indeterminate=!0)}V.indeterminate===!0&&(V.indeterminateNextState=V.children.every(a=>a.tickable!==!0||a.ticked!==!0))}return V};return e.nodes.forEach(s=>g(s,null)),u});re(()=>e.ticked,u=>{v.value=u}),re(()=>e.expanded,u=>{m.value=u});function R(u){const g=[].reduce,s=(j,o)=>{if(j||!o)return j;if(Array.isArray(o)===!0)return g.call(Object(o),s,j);if(o[e.nodeKey]===u)return o;if(o[e.childrenKey])return s(null,o[e.childrenKey])};return s(null,e.nodes)}function le(){return v.value.map(u=>R(u))}function se(){return m.value.map(u=>R(u))}function B(u){return u&&F.value[u]?F.value[u].expanded:!1}function O(){e.expanded!==void 0?l("update:expanded",[]):m.value=[]}function E(){const u=[],g=s=>{s[e.childrenKey]&&s[e.childrenKey].length!==0&&s.expandable!==!1&&s.disabled!==!0&&(u.push(s[e.nodeKey]),s[e.childrenKey].forEach(g))};e.nodes.forEach(g),e.expanded!==void 0?l("update:expanded",u):m.value=u}function U(u,g,s=R(u),j=F.value[u]){if(j.lazy&&j.lazy!=="loaded"){if(j.lazy==="loading")return;c.value[u]="loading",Array.isArray(s[e.childrenKey])!==!0&&(s[e.childrenKey]=[]),l("lazyLoad",{node:s,key:u,done:o=>{c.value[u]="loaded",s[e.childrenKey]=Array.isArray(o)===!0?o:[],Be(()=>{const r=F.value[u];(r==null?void 0:r.isParent)===!0&&J(u,!0)})},fail:()=>{delete c.value[u],s[e.childrenKey].length===0&&delete s[e.childrenKey]}})}else j.isParent===!0&&j.expandable===!0&&J(u,g)}function J(u,g){let s=m.value;const j=e.expanded!==void 0;if(j===!0&&(s=s.slice()),g){if(e.accordion&&F.value[u]){const o=[];F.value[u].parent?F.value[u].parent.children.forEach(r=>{r.key!==u&&r.expandable===!0&&o.push(r.key)}):e.nodes.forEach(r=>{const S=r[e.nodeKey];S!==u&&o.push(S)}),o.length!==0&&(s=s.filter(r=>o.includes(r)===!1))}s=s.concat([u]).filter((o,r,S)=>S.indexOf(o)===r)}else s=s.filter(o=>o!==u);j===!0?l("update:expanded",s):m.value=s}function X(u){return u&&F.value[u]?F.value[u].ticked:!1}function W(u,g){let s=v.value;const j=e.ticked!==void 0;j===!0&&(s=s.slice()),g?s=s.concat(u).filter((o,r,S)=>S.indexOf(o)===r):s=s.filter(o=>u.includes(o)===!1),j===!0&&l("update:ticked",s)}function Q(u,g,s){const j={tree:t,node:u,key:s,color:e.color,dark:h.value};return dt(j,"expanded",()=>g.expanded,o=>{o!==g.expanded&&U(s,o)}),dt(j,"ticked",()=>g.ticked,o=>{o!==g.ticked&&W([s],o)}),j}function q(u){return(e.filter?u.filter(g=>F.value[g[e.nodeKey]].matchesFilter):u).map(g=>de(g))}function A(u){if(u.icon!==void 0)return _(qe,{class:"q-tree__icon q-mr-sm",name:u.icon,color:u.iconColor});const g=u.img||u.avatar;if(g)return _("img",{class:`q-tree__${u.img?"img":"avatar"} q-mr-sm`,src:g})}function oe(){l("afterShow")}function ie(){l("afterHide")}function de(u){const g=u[e.nodeKey],s=F.value[g],j=u.header&&n[`header-${u.header}`]||n["default-header"],o=s.isParent===!0?q(u[e.childrenKey]):[],r=o.length!==0||s.lazy&&s.lazy!=="loaded";let S=u.body&&n[`body-${u.body}`]||n["default-body"];const K=j!==void 0||S!==void 0?Q(u,s,g):null;return S!==void 0&&(S=_("div",{class:"q-tree__node-body relative-position"},[_("div",{class:T.value},[S(K)])])),_("div",{key:g,class:`q-tree__node relative-position q-tree__node--${r===!0?"parent":"child"}`},[_("div",{class:"q-tree__node-header relative-position row no-wrap items-center"+(s.link===!0?" q-tree__node--link q-hoverable q-focusable":"")+(s.selected===!0?" q-tree__node--selected":"")+(s.disabled===!0?" q-tree__node--disabled":""),tabindex:s.link===!0?0:-1,ariaExpanded:o.length>0?s.expanded:null,role:"treeitem",onClick:z=>{Y(u,s,z)},onKeypress(z){rt(z)!==!0&&(z.keyCode===13?Y(u,s,z,!0):z.keyCode===32&&me(u,s,z,!0))}},[_("div",{class:"q-focus-helper",tabindex:-1,ref:z=>{f[s.key]=z}}),s.lazy==="loading"?_(st,{class:"q-tree__spinner",color:b.value}):r===!0?_(qe,{class:"q-tree__arrow"+(s.expanded===!0?" q-tree__arrow--rotate":""),name:p.value,onClick(z){me(u,s,z)}}):null,s.hasTicking===!0&&s.noTick!==!0?_(Ft,{class:"q-tree__tickbox",modelValue:s.indeterminate===!0?null:s.ticked,color:b.value,dark:h.value,dense:!0,keepColor:!0,disable:s.tickable!==!0,onKeydown:Ve,"onUpdate:modelValue":z=>{ue(s,z)}}):null,_("div",{class:"q-tree__node-header-content col row no-wrap items-center"+(s.selected===!0?P.value:T.value)},[j?j(K):[A(u),_("div",u[e.labelKey])]])]),r===!0?e.noTransition===!0?s.expanded===!0?_("div",{class:"q-tree__node-collapsible"+T.value,key:`${g}__q`},[S,_("div",{class:"q-tree__children"+(s.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]):null:_(ln,{duration:e.duration,onShow:oe,onHide:ie},()=>Ge(_("div",{class:"q-tree__node-collapsible"+T.value,key:`${g}__q`},[S,_("div",{class:"q-tree__children"+(s.disabled===!0?" q-tree__node--disabled":""),role:"group"},o)]),[[Dt,s.expanded]])):S])}function ce(u){var g;(g=f[u])==null||g.focus()}function Y(u,g,s,j){j!==!0&&g.selectable!==!1&&ce(g.key),x.value&&g.selectable?e.noSelectionUnset===!1?l("update:selected",g.key!==e.selected?g.key:null):g.key!==e.selected&&l("update:selected",g.key===void 0?null:g.key):me(u,g,s,j),typeof u.handler=="function"&&u.handler(u)}function me(u,g,s,j){s!==void 0&&Ve(s),j!==!0&&g.selectable!==!1&&ce(g.key),U(g.key,!g.expanded,u,g)}function ue(u,g){if(u.indeterminate===!0&&(g=u.indeterminateNextState),u.strictTicking)W([u.key],g);else if(u.leafTicking){const s=[],j=o=>{o.isParent?(g!==!0&&o.noTick!==!0&&o.tickable===!0&&s.push(o.key),o.leafTicking===!0&&o.children.forEach(j)):o.noTick!==!0&&o.tickable===!0&&(o.leafFilteredTicking!==!0||o.matchesFilter===!0)&&s.push(o.key)};j(u),W(s,g)}}return e.defaultExpandAll===!0&&E(),Object.assign(t,{getNodeByKey:R,getTickedNodes:le,getExpandedNodes:se,isExpanded:B,collapseAll:O,expandAll:E,setExpanded:U,isTicked:X,setTicked:W}),()=>{const u=q(e.nodes);return _("div",{class:i.value,role:"tree"},u.length===0?e.filter?e.noResultsLabel||d.lang.tree.noResults:e.noNodesLabel||d.lang.tree.noNodes:u)}}});function qt(e,n){if(n&&e===n)return null;const l=e.nodeName.toLowerCase();if(["div","li","ul","ol","blockquote"].includes(l)===!0)return e;const t=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,d=t.display;return d==="block"||d==="table"?e:qt(e.parentNode)}function $e(e,n,l){return!e||e===document.body?!1:l===!0&&e===n||(n===document?document.body:n).contains(e.parentNode)}function Ot(e,n,l){if(l||(l=document.createRange(),l.selectNode(e),l.setStart(e,0)),n.count===0)l.setEnd(e,n.count);else if(n.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<n.count?n.count-=e.textContent.length:(l.setEnd(e,n.count),n.count=0);else for(let t=0;n.count!==0&&t<e.childNodes.length;t++)l=Ot(e.childNodes[t],n,l);return l}const fn=/^https?:\/\//;class vn{constructor(n,l){this.el=n,this.eVm=l,this._range=null}get selection(){if(this.el){const n=document.getSelection();if($e(n.anchorNode,this.el,!0)&&$e(n.focusNode,this.el,!0))return n}return null}get hasSelection(){return this.selection!==null?this.selection.toString().length!==0:!1}get range(){const n=this.selection;return n!=null&&n.rangeCount?n.getRangeAt(0):this._range}get parent(){const n=this.range;if(n!==null){const l=n.startContainer;return l.nodeType===document.ELEMENT_NODE?l:l.parentNode}return null}get blockParent(){const n=this.parent;return n!==null?qt(n,this.el):null}save(n=this.range){n!==null&&(this._range=n)}restore(n=this._range){const l=document.createRange(),t=document.getSelection();n!==null?(l.setStart(n.startContainer,n.startOffset),l.setEnd(n.endContainer,n.endOffset),t.removeAllRanges(),t.addRange(l)):(t.selectAllChildren(this.el),t.collapseToEnd())}savePosition(){let n=-1,l;const t=document.getSelection(),d=this.el.parentNode;if(t.focusNode&&$e(t.focusNode,d))for(l=t.focusNode,n=t.focusOffset;l&&l!==d;)l!==this.el&&l.previousSibling?(l=l.previousSibling,n+=l.textContent.length):l=l.parentNode;this.savedPos=n}restorePosition(n=0){if(this.savedPos>0&&this.savedPos<n){const l=window.getSelection(),t=Ot(this.el,{count:this.savedPos});t&&(t.collapse(!1),l.removeAllRanges(),l.addRange(t))}}hasParent(n,l){const t=l?this.parent:this.blockParent;return t!==null?t.nodeName.toLowerCase()===n.toLowerCase():!1}hasParents(n,l,t=this.parent){return t===null?!1:n.includes(t.nodeName.toLowerCase())===!0?!0:l===!0?this.hasParents(n,l,t.parentNode):!1}is(n,l){if(this.selection===null)return!1;switch(n){case"formatBlock":return l==="DIV"&&this.parent===this.el||this.hasParent(l,l==="PRE");case"link":return this.hasParent("A",!0);case"fontSize":return document.queryCommandValue(n)===l;case"fontName":const t=document.queryCommandValue(n);return t===`"${l}"`||t===l;case"fullscreen":return this.eVm.inFullscreen.value;case"viewsource":return this.eVm.isViewingSource.value;case void 0:return!1;default:const d=document.queryCommandState(n);return l!==void 0?d===l:d}}getParentAttribute(n){return this.parent!==null?this.parent.getAttribute(n):null}can(n){if(n==="outdent")return this.hasParents(["blockquote","li"],!0);if(n==="indent")return this.hasParents(["li"],!0);if(n==="link")return this.selection!==null||this.is("link")}apply(n,l,t=St){if(n==="formatBlock")["BLOCKQUOTE","H1","H2","H3","H4","H5","H6"].includes(l)&&this.is(n,l)&&(n="outdent",l=null),l==="PRE"&&this.is(n,"PRE")&&(l="P");else if(n==="print"){t();const d=window.open();d.document.write(`
        <!doctype html>
        <html>
          <head>
            <title>Print - ${document.title}</title>
          </head>
          <body>
            <div>${this.el.innerHTML}</div>
          </body>
        </html>
      `),d.print(),d.close();return}else if(n==="link"){const d=this.getParentAttribute("href");if(d===null){const h=this.selectWord(this.selection),c=h?h.toString():"";if(!c.length&&(!this.range||!this.range.cloneContents().querySelector("img")))return;this.eVm.editLinkUrl.value=fn.test(c)?c:"https://",document.execCommand("createLink",!1,this.eVm.editLinkUrl.value),this.save(h.getRangeAt(0))}else this.eVm.editLinkUrl.value=d,this.range.selectNodeContents(this.parent),this.save();return}else if(n==="fullscreen"){this.eVm.toggleFullscreen(),t();return}else if(n==="viewsource"){this.eVm.isViewingSource.value=this.eVm.isViewingSource.value===!1,this.eVm.setContent(this.eVm.props.modelValue),t();return}document.execCommand(n,!1,l),t()}selectWord(n){if(n===null||n.isCollapsed!==!0||n.modify===void 0)return n;const l=document.createRange();l.setStart(n.anchorNode,n.anchorOffset),l.setEnd(n.focusNode,n.focusOffset);const t=l.collapsed?["backward","forward"]:["forward","backward"];l.detach();const d=n.focusNode,h=n.focusOffset;return n.collapse(n.anchorNode,n.anchorOffset),n.modify("move",t[0],"character"),n.modify("move",t[1],"word"),n.extend(d,h),n.modify("extend",t[1],"character"),n.modify("extend",t[0],"word"),n}}function At(e,n,l){n.handler?n.handler(e,l,l.caret):l.runCmd(n.cmd,n.param)}function ut(e){return _("div",{class:"q-editor__toolbar-group"},e)}function jt(e,n,l,t=!1){const d=t||(n.type==="toggle"?n.toggled?n.toggled(e):n.cmd&&e.caret.is(n.cmd,n.param):!1),h=[];if(n.tip&&e.$q.platform.is.desktop){const c=n.key?_("div",[_("small",`(CTRL + ${String.fromCharCode(n.key)})`)]):null;h.push(_(Ue,{delay:1e3},()=>[_("div",{innerHTML:n.tip}),c]))}return _(ee,{...e.buttonProps.value,icon:n.icon!==null?n.icon:void 0,color:d?n.toggleColor||e.props.toolbarToggleColor:n.color||e.props.toolbarColor,textColor:d&&!e.props.toolbarPush?null:n.textColor||e.props.toolbarTextColor,label:n.label,disable:n.disable?typeof n.disable=="function"?n.disable(e):!0:!1,size:"sm",onClick(c){l==null||l(),At(c,n,e)}},()=>h)}function pn(e,n){const l=n.list==="only-icons";let t=n.label,d=n.icon!==null?n.icon:void 0,h,c;function v(){f.component.proxy.hide()}if(l)c=n.options.map(i=>{const x=i.type===void 0?e.caret.is(i.cmd,i.param):!1;return x&&(t=i.tip,d=i.icon!==null?i.icon:void 0),jt(e,i,v,x)}),h=e.toolbarBackgroundClass.value,c=[ut(c)];else{const i=e.props.toolbarToggleColor!==void 0?`text-${e.props.toolbarToggleColor}`:null,x=e.props.toolbarTextColor!==void 0?`text-${e.props.toolbarTextColor}`:null,p=n.list==="no-icons";c=n.options.map(b=>{const T=b.disable?b.disable(e):!1,P=b.type===void 0?e.caret.is(b.cmd,b.param):!1;P&&(t=b.tip,d=b.icon!==null?b.icon:void 0);const M=b.htmlTip;return _(Se,{active:P,activeClass:i,clickable:!0,disable:T,dense:!0,onClick(F){var R;v(),(F==null?void 0:F.qAvoidFocus)!==!0&&((R=e.contentRef.value)==null||R.focus()),e.caret.restore(),At(F,b,e)}},()=>[p===!0?null:_(he,{class:P?i:x,side:!0},()=>_(qe,{name:b.icon!==null?b.icon:void 0})),_(he,M?()=>_("div",{class:"text-no-wrap",innerHTML:b.htmlTip}):b.tip?()=>_("div",{class:"text-no-wrap"},b.tip):void 0)])}),h=[e.toolbarBackgroundClass.value,x]}const m=n.highlight&&t!==n.label,f=_(on,{...e.buttonProps.value,noCaps:!0,noWrap:!0,color:m?e.props.toolbarToggleColor:e.props.toolbarColor,textColor:m&&!e.props.toolbarPush?null:e.props.toolbarTextColor,label:n.fixedLabel?n.label:t,icon:n.fixedIcon?n.icon!==null?n.icon:void 0:d,contentClass:h,onShow:i=>e.emit("dropdownShow",i),onHide:i=>e.emit("dropdownHide",i),onBeforeShow:i=>e.emit("dropdownBeforeShow",i),onBeforeHide:i=>e.emit("dropdownBeforeHide",i)},()=>c);return f}function yn(e){if(e.caret)return e.buttons.value.filter(n=>!e.isViewingSource.value||n.find(l=>l.cmd==="viewsource")).map(n=>ut(n.map(l=>e.isViewingSource.value&&l.cmd!=="viewsource"?!1:l.type==="slot"?Et(e.slots[l.slot]):l.type==="dropdown"?pn(e,l):jt(e,l))))}function bn(e,n,l,t={}){const d=Object.keys(t);if(d.length===0)return{};const h={default_font:{cmd:"fontName",param:e,icon:l,tip:n}};return d.forEach(c=>{const v=t[c];h[c]={cmd:"fontName",param:v,icon:l,tip:v,htmlTip:`<font face="${v}">${v}</font>`}}),h}function kn(e){if(e.caret){const n=e.props.toolbarColor||e.props.toolbarTextColor;let l=e.editLinkUrl.value;const t=()=>{e.caret.restore(),l!==e.editLinkUrl.value&&document.execCommand("createLink",!1,l===""?" ":l),e.editLinkUrl.value=null};return[_("div",{class:`q-mx-xs text-${n}`},`${e.$q.lang.editor.url}: `),_("input",{key:"qedt_btm_input",class:"col q-editor__link-input",value:l,onInput:d=>{It(d),l=d.target.value},onKeydown:d=>{if(rt(d)!==!0)switch(d.keyCode){case 13:return ht(d),t();case 27:ht(d),e.caret.restore(),(!e.editLinkUrl.value||e.editLinkUrl.value==="https://")&&document.execCommand("unlink"),e.editLinkUrl.value=null;break}}}),ut([_(ee,{key:"qedt_btm_rem",tabindex:-1,...e.buttonProps.value,label:e.$q.lang.label.remove,noCaps:!0,onClick:()=>{e.caret.restore(),document.execCommand("unlink"),e.editLinkUrl.value=null}}),_(ee,{key:"qedt_btm_upd",...e.buttonProps.value,label:e.$q.lang.label.update,noCaps:!0,onClick:t})])]}}const Sn=Object.prototype.toString,Xe=Object.prototype.hasOwnProperty,Cn=new Set(["Boolean","Number","String","Function","Array","Date","RegExp"].map(e=>"[object "+e+"]"));function ft(e){if(e!==Object(e)||Cn.has(Sn.call(e))===!0||e.constructor&&Xe.call(e,"constructor")===!1&&Xe.call(e.constructor.prototype,"isPrototypeOf")===!1)return!1;let n;for(n in e);return n===void 0||Xe.call(e,n)}function Lt(){let e,n,l,t,d,h,c=arguments[0]||{},v=1,m=!1;const f=arguments.length;for(typeof c=="boolean"&&(m=c,c=arguments[1]||{},v=2),Object(c)!==c&&typeof c!="function"&&(c={}),f===v&&(c=this,v--);v<f;v++)if((e=arguments[v])!==null)for(n in e)l=c[n],t=e[n],c!==t&&(m===!0&&t&&((d=Array.isArray(t))||ft(t)===!0)?(d===!0?h=Array.isArray(l)===!0?l:[]:h=ft(l)===!0?l:{},c[n]=Lt(m,h,t)):t!==void 0&&(c[n]=t));return c}var Tn=lt({name:"QEditor",props:{...ot,...rn,modelValue:{type:String,required:!0},readonly:Boolean,disable:Boolean,minHeight:{type:String,default:"10rem"},maxHeight:String,height:String,definitions:Object,fonts:Object,placeholder:String,toolbar:{type:Array,validator:e=>e.length===0||e.every(n=>n.length),default:()=>[["left","center","right","justify"],["bold","italic","underline","strike"],["undo","redo"]]},toolbarColor:String,toolbarBg:String,toolbarTextColor:String,toolbarToggleColor:{type:String,default:"primary"},toolbarOutline:Boolean,toolbarPush:Boolean,toolbarRounded:Boolean,paragraphTag:{type:String,validator:e=>["div","p"].includes(e),default:"div"},contentStyle:Object,contentClass:[Object,Array,String],square:Boolean,flat:Boolean,dense:Boolean},emits:[...sn,"update:modelValue","keydown","click","focus","blur","dropdownShow","dropdownHide","dropdownBeforeShow","dropdownBeforeHide","linkShow","linkHide"],setup(e,{slots:n,emit:l}){const{proxy:t}=at(),{$q:d}=t,h=it(e,d),{inFullscreen:c,toggleFullscreen:v}=cn(),m=Bt(),f=L(null),i=L(null),x=L(null),p=L(!1),b=w(()=>!e.readonly&&!e.disable);let T,P,M=e.modelValue;document.execCommand("defaultParagraphSeparator",!1,e.paragraphTag),T=window.getComputedStyle(document.body).fontFamily;const F=w(()=>e.toolbarBg?` bg-${e.toolbarBg}`:""),R=w(()=>{const o=e.toolbarOutline!==!0&&e.toolbarPush!==!0;return{type:"a",flat:o,noWrap:!0,outline:e.toolbarOutline,push:e.toolbarPush,rounded:e.toolbarRounded,dense:!0,color:e.toolbarColor,disable:!b.value,size:"sm"}}),le=w(()=>{const o=d.lang.editor,r=d.iconSet.editor;return{bold:{cmd:"bold",icon:r.bold,tip:o.bold,key:66},italic:{cmd:"italic",icon:r.italic,tip:o.italic,key:73},strike:{cmd:"strikeThrough",icon:r.strikethrough,tip:o.strikethrough,key:83},underline:{cmd:"underline",icon:r.underline,tip:o.underline,key:85},unordered:{cmd:"insertUnorderedList",icon:r.unorderedList,tip:o.unorderedList},ordered:{cmd:"insertOrderedList",icon:r.orderedList,tip:o.orderedList},subscript:{cmd:"subscript",icon:r.subscript,tip:o.subscript,htmlTip:"x<subscript>2</subscript>"},superscript:{cmd:"superscript",icon:r.superscript,tip:o.superscript,htmlTip:"x<superscript>2</superscript>"},link:{cmd:"link",disable:S=>S.caret&&!S.caret.can("link"),icon:r.hyperlink,tip:o.hyperlink,key:76},fullscreen:{cmd:"fullscreen",icon:r.toggleFullscreen,tip:o.toggleFullscreen,key:70},viewsource:{cmd:"viewsource",icon:r.viewSource,tip:o.viewSource},quote:{cmd:"formatBlock",param:"BLOCKQUOTE",icon:r.quote,tip:o.quote,key:81},left:{cmd:"justifyLeft",icon:r.left,tip:o.left},center:{cmd:"justifyCenter",icon:r.center,tip:o.center},right:{cmd:"justifyRight",icon:r.right,tip:o.right},justify:{cmd:"justifyFull",icon:r.justify,tip:o.justify},print:{type:"no-state",cmd:"print",icon:r.print,tip:o.print,key:80},outdent:{type:"no-state",disable:S=>S.caret&&!S.caret.can("outdent"),cmd:"outdent",icon:r.outdent,tip:o.outdent},indent:{type:"no-state",disable:S=>S.caret&&!S.caret.can("indent"),cmd:"indent",icon:r.indent,tip:o.indent},removeFormat:{type:"no-state",cmd:"removeFormat",icon:r.removeFormat,tip:o.removeFormat},hr:{type:"no-state",cmd:"insertHorizontalRule",icon:r.hr,tip:o.hr},undo:{type:"no-state",cmd:"undo",icon:r.undo,tip:o.undo,key:90},redo:{type:"no-state",cmd:"redo",icon:r.redo,tip:o.redo,key:89},h1:{cmd:"formatBlock",param:"H1",icon:r.heading1||r.heading,tip:o.heading1,htmlTip:`<h1 class="q-ma-none">${o.heading1}</h1>`},h2:{cmd:"formatBlock",param:"H2",icon:r.heading2||r.heading,tip:o.heading2,htmlTip:`<h2 class="q-ma-none">${o.heading2}</h2>`},h3:{cmd:"formatBlock",param:"H3",icon:r.heading3||r.heading,tip:o.heading3,htmlTip:`<h3 class="q-ma-none">${o.heading3}</h3>`},h4:{cmd:"formatBlock",param:"H4",icon:r.heading4||r.heading,tip:o.heading4,htmlTip:`<h4 class="q-ma-none">${o.heading4}</h4>`},h5:{cmd:"formatBlock",param:"H5",icon:r.heading5||r.heading,tip:o.heading5,htmlTip:`<h5 class="q-ma-none">${o.heading5}</h5>`},h6:{cmd:"formatBlock",param:"H6",icon:r.heading6||r.heading,tip:o.heading6,htmlTip:`<h6 class="q-ma-none">${o.heading6}</h6>`},p:{cmd:"formatBlock",param:e.paragraphTag,icon:r.heading,tip:o.paragraph},code:{cmd:"formatBlock",param:"PRE",icon:r.code,htmlTip:`<code>${o.code}</code>`},"size-1":{cmd:"fontSize",param:"1",icon:r.size1||r.size,tip:o.size1,htmlTip:`<font size="1">${o.size1}</font>`},"size-2":{cmd:"fontSize",param:"2",icon:r.size2||r.size,tip:o.size2,htmlTip:`<font size="2">${o.size2}</font>`},"size-3":{cmd:"fontSize",param:"3",icon:r.size3||r.size,tip:o.size3,htmlTip:`<font size="3">${o.size3}</font>`},"size-4":{cmd:"fontSize",param:"4",icon:r.size4||r.size,tip:o.size4,htmlTip:`<font size="4">${o.size4}</font>`},"size-5":{cmd:"fontSize",param:"5",icon:r.size5||r.size,tip:o.size5,htmlTip:`<font size="5">${o.size5}</font>`},"size-6":{cmd:"fontSize",param:"6",icon:r.size6||r.size,tip:o.size6,htmlTip:`<font size="6">${o.size6}</font>`},"size-7":{cmd:"fontSize",param:"7",icon:r.size7||r.size,tip:o.size7,htmlTip:`<font size="7">${o.size7}</font>`}}}),se=w(()=>{const o=e.definitions||{},r=e.definitions||e.fonts?Lt(!0,{},le.value,o,bn(T,d.lang.editor.defaultFont,d.iconSet.editor.font,e.fonts)):le.value;return e.toolbar.map(S=>S.map(K=>{if(K.options)return{type:"dropdown",icon:K.icon,label:K.label,size:"sm",dense:!0,fixedLabel:K.fixedLabel,fixedIcon:K.fixedIcon,highlight:K.highlight,list:K.list,options:K.options.map(Te=>r[Te])};const z=r[K];return z?z.type==="no-state"||o[K]&&(z.cmd===void 0||le.value[z.cmd]&&le.value[z.cmd].type==="no-state")?z:Object.assign({type:"toggle"},z):{type:"slot",slot:K}}))}),B={$q:d,props:e,slots:n,emit:l,inFullscreen:c,toggleFullscreen:v,runCmd:u,isViewingSource:p,editLinkUrl:x,toolbarBackgroundClass:F,buttonProps:R,contentRef:i,buttons:se,setContent:ue};re(()=>e.modelValue,o=>{M!==o&&(M=o,ue(o,!0))}),re(x,o=>{l(`link${o?"Show":"Hide"}`)});const O=w(()=>e.toolbar&&e.toolbar.length!==0),E=w(()=>{const o={},r=S=>{S.key&&(o[S.key]={cmd:S.cmd,param:S.param})};return se.value.forEach(S=>{S.forEach(K=>{K.options?K.options.forEach(r):r(K)})}),o}),U=w(()=>c.value?e.contentStyle:[{minHeight:e.minHeight,height:e.height,maxHeight:e.maxHeight},e.contentStyle]),J=w(()=>`q-editor q-editor--${p.value===!0?"source":"default"}`+(e.disable===!0?" disabled":"")+(c.value===!0?" fullscreen column":"")+(e.square===!0?" q-editor--square no-border-radius":"")+(e.flat===!0?" q-editor--flat":"")+(e.dense===!0?" q-editor--dense":"")+(h.value===!0?" q-editor--dark q-dark":"")),X=w(()=>[e.contentClass,"q-editor__content",{col:c.value,"overflow-auto":c.value||e.maxHeight}]),W=w(()=>e.disable===!0?{"aria-disabled":"true"}:{});function Q(){if(i.value!==null){const o=`inner${p.value===!0?"Text":"HTML"}`,r=i.value[o];r!==e.modelValue&&(M=r,l("update:modelValue",r))}}function q(o){if(l("keydown",o),o.ctrlKey!==!0||rt(o)===!0){g();return}const r=o.keyCode,S=E.value[r];if(S!==void 0){const{cmd:K,param:z}=S;Ve(o),u(K,z,!1)}}function A(o){g(),l("click",o)}function oe(o){if(i.value!==null){const{scrollTop:r,scrollHeight:S}=i.value;P=S-r}B.caret.save(),l("blur",o)}function ie(o){Be(()=>{i.value!==null&&P!==void 0&&(i.value.scrollTop=i.value.scrollHeight-P)}),l("focus",o)}function de(o){const r=f.value;if(r!==null&&r.contains(o.target)===!0&&(o.relatedTarget===null||r.contains(o.relatedTarget)!==!0)){const S=`inner${p.value===!0?"Text":"HTML"}`;B.caret.restorePosition(i.value[S].length),g()}}function ce(o){const r=f.value;r!==null&&r.contains(o.target)===!0&&(o.relatedTarget===null||r.contains(o.relatedTarget)!==!0)&&(B.caret.savePosition(),g())}function Y(){P=void 0}function me(o){B.caret.save()}function ue(o,r){if(i.value!==null){r===!0&&B.caret.savePosition();const S=`inner${p.value===!0?"Text":"HTML"}`;i.value[S]=o,r===!0&&(B.caret.restorePosition(i.value[S].length),g())}}function u(o,r,S=!0){s(),B.caret.restore(),B.caret.apply(o,r,()=>{s(),B.caret.save(),S&&g()})}function g(){setTimeout(()=>{x.value=null,t.$forceUpdate()},1)}function s(){Mt(()=>{var o;(o=i.value)==null||o.focus({preventScroll:!0})})}function j(){return i.value}return Vt(()=>{B.caret=t.caret=new vn(i.value,B),ue(e.modelValue),g(),document.addEventListener("selectionchange",me)}),Gt(()=>{document.removeEventListener("selectionchange",me)}),Object.assign(t,{runCmd:u,refreshToolbar:g,focus:s,getContentEl:j}),()=>{let o;if(O.value){const r=[_("div",{key:"qedt_top",class:"q-editor__toolbar row no-wrap scroll-x"+F.value},yn(B))];x.value!==null&&r.push(_("div",{key:"qedt_btm",class:"q-editor__toolbar row no-wrap items-center scroll-x"+F.value},kn(B))),o=_("div",{key:"toolbar_ctainer",class:"q-editor__toolbars-container"},r)}return _("div",{ref:f,class:J.value,style:{height:c.value===!0?"100%":null},...W.value,onFocusin:de,onFocusout:ce},[o,_("div",{ref:i,style:U.value,class:X.value,contenteditable:b.value,placeholder:e.placeholder,...m.listeners.value,onInput:Q,onKeydown:q,onClick:A,onBlur:oe,onFocus:ie,onMousedown:Y,onTouchstartPassive:Y})])}}});const xn={beforeMount(e,n){if(typeof n.value!="function"){console.warn(`Expect a function, got ${n.value}`);return}let l=null;const t=c=>{c.type==="click"&&c.button!==0||l===null&&(l=setTimeout(()=>{h(c)},500))},d=()=>{l!==null&&(clearTimeout(l),l=null)},h=c=>{n.value(c)};e.addEventListener("mousedown",t),e.addEventListener("touchstart",t),e.addEventListener("click",d),e.addEventListener("mouseout",d),e.addEventListener("touchend",d),e.addEventListener("touchcancel",d)}},Nn={name:"AssistantAI",props:{selectedNode:{type:Object,required:!0},fullObject:{type:Object,required:!0},addObjectArrayItem:{type:Function,required:!0}},emits:["loading","update:selectedNode"],setup(e,{emit:n}){const l=L([]),t=L(!1),d=dn(),h=["lessonTools","programmingLanguages","lessonGrade","lessonDescription","lessonDuration","lessonTopic","lessonTitle","lessonProject.projectDescription","lessonProject.projectFeatures","lessonProject.projectShortInstruction","lessonSkills","lessonObjectives","lessonTips","lessonDifferentiation.increaseDifficultyBys","lessonDifferentiation.simplifyBys"],c=w(()=>l.value.map(p=>hn(p))),v=w(()=>{const p=e.fullObject.lessonTitle||"",b=e.fullObject.lessonTopic||"",T=e.fullObject.lessonDescription||"";return p.trim()!==""||b.trim()!==""||T.trim()!==""}),m=p=>{const b=h.indexOf(p);if(console.log("Node hi\u1EC7n t\u1EA1i:",p,"V\u1ECB tr\xED index:",b),b===-1)return null;const T=e.fullObject[p];if(T&&T!==""&&T.length>0)return console.log("value:",T),T;const P={};for(let M=0;M<=b;M++){const F=h[M],R=e.fullObject[F];R&&R!==""&&(P[F]=R)}return Object.keys(P).length>0?P:null},f=async()=>{if(!e.selectedNode)return;t.value=!0,n("loading",!0);const p=e.selectedNode.key,b=m(p);console.log("nodeInfo",b);let T="";const P=e.selectedNode.value,M=e.selectedNode.key;P==null||P===""||P.length===0?(console.log("Tr\u01B0\u1EDDng h\u1EE3p 1: Ch\u01B0a c\xF3 th\xF4ng tin"),T=`D\u1EF1a tr\xEAn th\xF4ng tin c\u1EE7a c\xE1c tr\u01B0\u1EDDng tr\u01B0\u1EDBc \u0111\xF3: ${JSON.stringify(b)}, h\xE3y \u0111\u01B0a ra g\u1EE3i \xFD cho tr\u01B0\u1EDDng "${p}". `,M.includes("lessonObjectives")?T+=`H\xE3y \u0111\u1EC1 xu\u1EA5t m\u1ED9t m\u1EE5c ti\xEAu m\u1EDBi ho\u1EB7c c\u1EA3i thi\u1EC7n m\u1EE5c ti\xEAu n\xE0y. Tr\u1EA3 v\u1EC1 k\u1EBFt qu\u1EA3 d\u01B0\u1EDBi d\u1EA1ng m\u1ED9t object c\xF3 c\u1EA5u tr\xFAc gi\u1ED1ng h\u1EC7t nh\u01B0 sau:
            {
              "objDescription": "M\xF4 t\u1EA3 m\u1EE5c ti\xEAu",
              "objRelatedGlossaries": ["Thu\u1EADt ng\u1EEF 1", "Thu\u1EADt ng\u1EEF 2"],
              "objRelatedSkill": ["K\u1EF9 n\u0103ng 1", "K\u1EF9 n\u0103ng 2"],
              "objRelatedStandard": ["Ti\xEAu chu\u1EA9n 1", "Ti\xEAu chu\u1EA9n 2"]
            }
            \u0110\u1EA3m b\u1EA3o r\u1EB1ng c\xE1c tr\u01B0\u1EDDng trong object \u0111\u1EC1u \u0111\u01B0\u1EE3c \u0111i\u1EC1n \u0111\u1EA7y \u0111\u1EE7 v\xE0 ph\xF9 h\u1EE3p v\u1EDBi n\u1ED9i dung c\u1EE7a m\u1EE5c ti\xEAu.`:T+=`
          N\u1EBFu \u0111\u1ECBnh d\u1EA1ng gi\xE1 tr\u1ECB l\xE0 m\u1ED9t string array (d\u1EA1ng ["", "", "",...]), h\xE3y \u0111\u1EC1 xu\u1EA5t m\u1ED9t phi\xEAn b\u1EA3n m\u1EDBi thay th\u1EBF ph\xF9 h\u1EE3p h\u01A1n, \u0111\u1ECBnh d\u1EA1ng l\xE0 string, n\u1ED9i dung thay \u0111\u1ED5i ph\xF9 h\u1EE3p gi\u1ED1ng v\u1EDBi 1 string trong array ${JSON.stringify(P)}  v\xE0 \u0111\u1ED9 d\xE0i t\u01B0\u01A1ng t\u1EF1.
          N\u1EBFu \u0111\u1ECBnh d\u1EA1ng gi\xE1 tr\u1ECB l\xE0 m\u1ED9t array object (d\u1EA1ng {[], [], [],...}), h\xE3y \u0111\u1EC1 xu\u1EA5t m\u1ED9t phi\xEAn b\u1EA3n m\u1EDBi thay th\u1EBF ph\xF9 h\u1EE3p h\u01A1n, \u0111\u1ECBnh d\u1EA1ng l\xE0 object, n\u1ED9i dung thay \u0111\u1ED5i ph\xF9 h\u1EE3p gi\u1ED1ng v\u1EDBi 1 object trong array ${JSON.stringify(P)}  v\xE0 \u0111\u1ED9 d\xE0i t\u01B0\u01A1ng t\u1EF1.
          N\u1EBFu \u0111\u1ECBnh d\u1EA1ng l\xE0 (string, number, boolean, null,...), ch\u1EC9 tr\u1EA3 v\u1EC1 gi\xE1 tr\u1ECB m\u1EDBi thay th\u1EBF ph\xF9 h\u1EE3p h\u01A1n v\u1EDBi \u0111\xFAng ki\u1EC3u d\u1EEF li\u1EC7u m\u1EABu, kh\xF4ng c\u1EA7n gi\u1EA3i th\xEDch hay \u0111\u1ECBnh d\u1EA1ng JSON.
          `):(console.log("Tr\u01B0\u1EDDng h\u1EE3p 2: \u0110\xE3 c\xF3 th\xF4ng tin"),M.includes("lessonObjectives")?T=`D\u1EF1a tr\xEAn m\u1EE5c ti\xEAu b\xE0i h\u1ECDc hi\u1EC7n t\u1EA1i: ${JSON.stringify(P)}, h\xE3y \u0111\u1EC1 xu\u1EA5t m\u1ED9t m\u1EE5c ti\xEAu m\u1EDBi ho\u1EB7c c\u1EA3i thi\u1EC7n m\u1EE5c ti\xEAu n\xE0y. Tr\u1EA3 v\u1EC1 k\u1EBFt qu\u1EA3 d\u01B0\u1EDBi d\u1EA1ng m\u1ED9t object c\xF3 c\u1EA5u tr\xFAc gi\u1ED1ng h\u1EC7t nh\u01B0 sau:
          {
            "objDescription": "M\xF4 t\u1EA3 m\u1EE5c ti\xEAu",
            "objRelatedGlossaries": ["Thu\u1EADt ng\u1EEF 1", "Thu\u1EADt ng\u1EEF 2"],
            "objRelatedSkill": ["K\u1EF9 n\u0103ng 1", "K\u1EF9 n\u0103ng 2"],
            "objRelatedStandard": ["Ti\xEAu chu\u1EA9n 1", "Ti\xEAu chu\u1EA9n 2"]
          }
          \u0110\u1EA3m b\u1EA3o r\u1EB1ng c\xE1c tr\u01B0\u1EDDng trong object \u0111\u1EC1u \u0111\u01B0\u1EE3c \u0111i\u1EC1n \u0111\u1EA7y \u0111\u1EE7 v\xE0 ph\xF9 h\u1EE3p v\u1EDBi n\u1ED9i dung c\u1EE7a m\u1EE5c ti\xEAu.`:T=`\u0110\xE2y l\xE0 gi\xE1 tr\u1ECB hi\u1EC7n t\u1EA1i c\u1EE7a tr\u01B0\u1EDDng "${M}": ${JSON.stringify(P)}.
          N\u1EBFu \u0111\u1ECBnh d\u1EA1ng gi\xE1 tr\u1ECB l\xE0 m\u1ED9t string array (d\u1EA1ng ["", "", "",...]), h\xE3y \u0111\u1EC1 xu\u1EA5t m\u1ED9t phi\xEAn b\u1EA3n m\u1EDBi thay th\u1EBF ph\xF9 h\u1EE3p h\u01A1n, \u0111\u1ECBnh d\u1EA1ng l\xE0 string, n\u1ED9i dung thay \u0111\u1ED5i ph\xF9 h\u1EE3p gi\u1ED1ng v\u1EDBi 1 string trong array ${JSON.stringify(P)}  v\xE0 \u0111\u1ED9 d\xE0i t\u01B0\u01A1ng t\u1EF1.
          N\u1EBFu \u0111\u1ECBnh d\u1EA1ng gi\xE1 tr\u1ECB l\xE0 m\u1ED9t array object (d\u1EA1ng {[], [], [],...}), h\xE3y \u0111\u1EC1 xu\u1EA5t m\u1ED9t phi\xEAn b\u1EA3n m\u1EDBi thay th\u1EBF ph\xF9 h\u1EE3p h\u01A1n, \u0111\u1ECBnh d\u1EA1ng l\xE0 object, n\u1ED9i dung thay \u0111\u1ED5i ph\xF9 h\u1EE3p gi\u1ED1ng v\u1EDBi 1 object trong array ${JSON.stringify(P)}  v\xE0 \u0111\u1ED9 d\xE0i t\u01B0\u01A1ng t\u1EF1.
          N\u1EBFu \u0111\u1ECBnh d\u1EA1ng l\xE0 (string, number, boolean, null,...), ch\u1EC9 tr\u1EA3 v\u1EC1 gi\xE1 tr\u1ECB m\u1EDBi thay th\u1EBF ph\xF9 h\u1EE3p h\u01A1n v\u1EDBi \u0111\xFAng ki\u1EC3u d\u1EEF li\u1EC7u m\u1EABu, kh\xF4ng c\u1EA7n gi\u1EA3i th\xEDch hay \u0111\u1ECBnh d\u1EA1ng JSON.
          `),T+=`Y\xEAu c\u1EA7u n\u1ED9i dung tr\u1EA3 v\u1EC1 ph\u1EA3i kh\xE1c v\u1EDBi n\u1ED9i dung hi\u1EC7n t\u1EA1i c\u1EE7a tr\u01B0\u1EDDng "${M}": ${JSON.stringify(P)}`;try{const F=await d.getAISuggestion(T);l.value=[F.trim()]}catch(F){console.error("Error generating suggestion:",F),l.value=["Xin l\u1ED7i, \u0111\xE3 x\u1EA3y ra l\u1ED7i khi t\u1EA1o g\u1EE3i \xFD."]}finally{t.value=!1,n("loading",!1)}};re(()=>e.selectedNode,f,{deep:!0});const i=p=>{if(l.value[p]){const b=l.value[p];let T;try{T=JSON.parse(b)}catch{T=b}if(Array.isArray(e.selectedNode.value))e.selectedNode.key.includes("lessonObjectives"),e.addObjectArrayItem(e.selectedNode,T);else{const P={...e.selectedNode,value:T};n("update:selectedNode",P)}}},x=()=>{l.value=[],f()};return re(()=>e.selectedNode,p=>{console.log("selectedNode trong AssistantAI \u0111\xE3 thay \u0111\u1ED5i:",p),p&&f()},{immediate:!0}),{suggestions:l,isLoading:t,renderedSuggestions:c,acceptSuggestion:i,resetSuggestion:x,canShowButtons:v}}},wn={class:"assistant-ai"},_n={key:0,class:"text-center"},qn={key:1},On={class:"row items-center"},An=["innerHTML"],jn={key:0,class:"q-gutter-sm"};function Ln(e,n,l,t,d,h){return C(),I("div",wn,[t.suggestions.length>0||t.isLoading?(C(),te(Me,{key:0},{default:N(()=>[y(ge,null,{default:N(()=>[n[3]||(n[3]=Z("div",{class:"text-h6"},"G\u1EE3i \xFD AI",-1)),t.isLoading?(C(),I("div",_n,[y(st,{color:"primary",size:"3em"}),n[0]||(n[0]=Z("p",null,"\u0110ang t\u1EA1o g\u1EE3i \xFD...",-1))])):(C(),I("div",qn,[(C(!0),I(ve,null,pe(t.renderedSuggestions,(c,v)=>(C(),I("div",{key:v,class:"q-mb-md"},[Z("div",On,[Z("div",{innerHTML:c,class:"col"},null,8,An),t.canShowButtons?(C(),I("div",jn,[y(ee,{dense:"",flat:"",color:"primary",icon:"check",onClick:m=>t.acceptSuggestion(v)},{default:N(()=>[y(Ue,null,{default:N(()=>n[1]||(n[1]=[Ce("Ch\u1EA5p nh\u1EADn g\u1EE3i \xFD")])),_:1})]),_:2},1032,["onClick"]),y(ee,{dense:"",flat:"",color:"secondary",icon:"refresh",onClick:t.resetSuggestion},{default:N(()=>[y(Ue,null,{default:N(()=>n[2]||(n[2]=[Ce("T\u1EA1o l\u1EA1i g\u1EE3i \xFD")])),_:1})]),_:1},8,["onClick"])])):ne("",!0)])]))),128))]))]),_:1})]),_:1})):ne("",!0)])}var Pn=ze(Nn,[["render",Ln]]);const Fn=[{value:30,label:"30 ph\xFAt"},{value:45,label:"45 ph\xFAt"},{value:60,label:"1 gi\u1EDD"},{value:90,label:"1 gi\u1EDD 30 ph\xFAt"},{value:120,label:"2 gi\u1EDD"},{value:180,label:"3 gi\u1EDD"}];var vt={lessonDurations:Fn};const Dn=[{value:"S\u01A1 c\u1EA5p",label:"S\u01A1 c\u1EA5p"},{value:"Trung c\u1EA5p",label:"Trung c\u1EA5p"},{value:"N\xE2ng cao",label:"N\xE2ng cao"}];var pt={lessonLevels:Dn};const En=[{value:"Ti\u1EC3u h\u1ECDc",label:"Ti\u1EC3u h\u1ECDc"},{value:"Trung h\u1ECDc c\u01A1 s\u1EDF",label:"Trung h\u1ECDc c\u01A1 s\u1EDF"},{value:"Trung h\u1ECDc ph\u1ED5 th\xF4ng",label:"Trung h\u1ECDc ph\u1ED5 th\xF4ng"},{value:"\u0110\u1EA1i h\u1ECDc / Cao \u0111\u1EB3ng",label:"\u0110\u1EA1i h\u1ECDc / Cao \u0111\u1EB3ng"}];var yt={lessonGrades:En};const In={name:"EditableList",props:{initialItems:{type:Array,required:!0},addButtonLabel:{type:String,default:"Th\xEAm m\u1EE5c"},isDropdown:{type:Boolean,default:!1},fieldName:{type:String,required:!0},suggestions:{type:Array,default:()=>[]}},emits:["update:items"],setup(e,{emit:n}){const l=L([...e.initialItems]),t=L([...e.suggestions]),d=(m,f,i)=>{if(m===""){f(()=>{t.value=e.suggestions});return}f(()=>{const x=m.toLowerCase();t.value=e.suggestions.filter(p=>p.label.toLowerCase().indexOf(x)>-1)})},h=()=>{l.value.push(""),v()},c=m=>{l.value.splice(m,1),v()},v=()=>{n("update:items",l.value)};return re(()=>e.initialItems,m=>{l.value=[...m]}),{items:l,filteredOptions:t,addItem:h,removeItem:c,emitUpdate:v,filterOptions:d}}};function Bn(e,n,l,t,d,h){return C(),I("div",null,[y(ct,{bordered:"",separator:""},{default:N(()=>[(C(!0),I(ve,null,pe(t.items,(c,v)=>(C(),te(Se,{key:v},{default:N(()=>[y(he,null,{default:N(()=>[l.isDropdown?(C(),te(Nt,{key:1,modelValue:t.items[v],"onUpdate:modelValue":[m=>t.items[v]=m,t.emitUpdate],options:t.filteredOptions,"option-value":"value","option-label":"label","emit-value":"","map-options":"","use-input":"","fill-input":"","hide-selected":"","input-debounce":"0",onFilter:t.filterOptions},{"no-option":N(()=>[y(Se,null,{default:N(()=>[y(he,{class:"text-grey"},{default:N(()=>n[0]||(n[0]=[Ce(" Kh\xF4ng t\xECm th\u1EA5y k\u1EBFt qu\u1EA3 ")])),_:1})]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue","options","onFilter"])):(C(),te(ye,{key:0,modelValue:t.items[v],"onUpdate:modelValue":m=>t.items[v]=m,dense:"",filled:"",onBlur:t.emitUpdate},null,8,["modelValue","onUpdate:modelValue","onBlur"]))]),_:2},1024),y(he,{side:""},{default:N(()=>[y(ee,{flat:"",round:"",color:"negative",icon:"delete",onClick:m=>t.removeItem(v)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),y(ee,{label:l.addButtonLabel,color:"primary",onClick:t.addItem,class:"q-mt-sm"},null,8,["label","onClick"])])}var bt=ze(In,[["render",Bn],["__scopeId","data-v-1ac1c2ba"]]);const Vn=[{value:!0,label:"Ph\xF9 h\u1EE3p cho gi\u1EA3ng d\u1EA1y k\u1EBFt h\u1EE3p"},{value:!1,label:"Kh\xF4ng ph\xF9 h\u1EE3p cho gi\u1EA3ng d\u1EA1y k\u1EBFt h\u1EE3p"}];var We={lessonSuitableForHybridTeaching:Vn};const Gn=[{value:"VS Code",label:"VS Code"},{value:"Vue DevTools",label:"Vue DevTools"},{value:"Git",label:"Git"},{value:"Node.js",label:"Node.js"},{value:"npm",label:"npm"},{value:"Quasar CLI",label:"Quasar CLI"},{value:"Chrome Developer Tools",label:"Chrome Developer Tools"},{value:"Postman",label:"Postman"},{value:"Firebase",label:"Firebase"}];var Mn={lessonTools:Gn};const Un=[{value:"Front-end Development",label:"Front-end Development"},{value:"JavaScript",label:"JavaScript"},{value:"Vue.js",label:"Vue.js"},{value:"React",label:"React"},{value:"Angular",label:"Angular"},{value:"HTML",label:"HTML"},{value:"CSS",label:"CSS"},{value:"Responsive Design",label:"Responsive Design"},{value:"State Management",label:"State Management"},{value:"API Integration",label:"API Integration"}];var zn={lessonSkills:Un};const Hn=[{value:"laptop",label:"M\xE1y t\xEDnh x\xE1ch tay"},{value:"computer",label:"M\xE1y t\xEDnh \u0111\u1EC3 b\xE0n"},{value:"tablet",label:"M\xE1y t\xEDnh b\u1EA3ng"},{value:"smartphone",label:"\u0110i\u1EC7n tho\u1EA1i th\xF4ng minh"},{value:"chromebook",label:"Chromebook"}];var Kn={devices:Hn};const Rn=["lessonDuration","lessonLevel","lessonGrade","lessonSuitableForHybridTeaching"],Jn=["lessonTitle","lessonTopic","lessonDescription","lessonCoverImage"],Qn={dropdownArrayFields:["lessonTools","devices","lessonSkills"],inputArrayFields:["lessonObjectives","lessonTips","lessonResources","simplifyBys","increaseDifficultyBys"],objectArrayFields:["lessonObjectives"]},$n=["lessonProject"];var Ye={dropdownFields:Rn,textFields:Jn,arrayFields:Qn,objectFields:$n};const Xn={guidelines:["\u0110\u1EA3m b\u1EA3o d\u1EF1 \xE1n ph\xF9 h\u1EE3p v\u1EDBi \u0111\u1ED9 tu\u1ED5i v\xE0 tr\xECnh \u0111\u1ED9 c\u1EE7a h\u1ECDc sinh","D\u1EF1 \xE1n n\xEAn t\xEDch h\u1EE3p \xEDt nh\u1EA5t 2 l\u0129nh v\u1EF1c STEM","N\xEAn c\xF3 t\xEDnh \u1EE9ng d\u1EE5ng th\u1EF1c t\u1EBF"],constraints:["Ph\u1EA3i bao g\u1ED3m \xEDt nh\u1EA5t 2 l\u0129nh v\u1EF1c STEM","Th\u1EDDi gian th\u1EF1c hi\u1EC7n d\u1EF1 \xE1n kh\xF4ng qu\xE1 4 tu\u1EA7n"],sample:"X\xE2y d\u1EF1ng m\u1ED9t h\u1EC7 th\u1ED1ng t\u01B0\u1EDBi c\xE2y t\u1EF1 \u0111\u1ED9ng s\u1EED d\u1EE5ng c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m v\xE0 vi \u0111i\u1EC1u khi\u1EC3n Arduino"},Wn={guidelines:["Ng\u1EAFn g\u1ECDn, h\u1EA5p d\u1EABn v\xE0 d\u1EC5 nh\u1EDB","Ph\u1EA3n \xE1nh \u0111\u01B0\u1EE3c b\u1EA3n ch\u1EA5t c\u1EE7a d\u1EF1 \xE1n"],constraints:["\u0110\u1ED9 d\xE0i t\u1EEB 3 \u0111\u1EBFn 10 t\u1EEB","Kh\xF4ng qu\xE1 50 k\xFD t\u1EF1 bao g\u1ED3m c\u1EA3 kho\u1EA3ng tr\u1EAFng"],sample:"V\u01B0\u1EDDn Th\xF4ng Minh IoT"},Yn={guidelines:["M\xF4 t\u1EA3 r\xF5 r\xE0ng m\u1EE5c ti\xEAu v\xE0 k\u1EBFt qu\u1EA3 mong \u0111\u1EE3i c\u1EE7a d\u1EF1 \xE1n","N\xEAu b\u1EADt \u0111\u01B0\u1EE3c t\xEDnh li\xEAn ng\xE0nh c\u1EE7a STEM trong d\u1EF1 \xE1n"],constraints:["\u0110\u1ED9 d\xE0i t\u1EEB 50 \u0111\u1EBFn 200 t\u1EEB","Ph\u1EA3i \u0111\u1EC1 c\u1EADp \u0111\u1EBFn \xEDt nh\u1EA5t 2 l\u0129nh v\u1EF1c STEM"],sample:"D\u1EF1 \xE1n n\xE0y k\u1EBFt h\u1EE3p ki\u1EBFn th\u1EE9c v\u1EC1 sinh h\u1ECDc th\u1EF1c v\u1EADt, k\u1EF9 thu\u1EADt \u0111i\u1EC7n t\u1EED v\xE0 l\u1EADp tr\xECnh \u0111\u1EC3 t\u1EA1o ra m\u1ED9t h\u1EC7 th\u1ED1ng t\u01B0\u1EDBi c\xE2y t\u1EF1 \u0111\u1ED9ng. S\u1EA3n ph\u1EA9m \u0111\u01B0\u1EE3c trang b\u1ECB c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m, vi \u0111i\u1EC1u khi\u1EC3n Arduino, \u0111\u1EC3 th\u1EF1c hi\u1EC7n t\u01B0\u1EDBi n\u01B0\u1EDBc t\u1EF1 \u0111\u1ED9ng theo \u0111\u1ED9 \u1EA9m \u0111\u1EA5t hi\u1EC7u qu\u1EA3."},Zn={guidelines:["Li\xEAn quan ch\u1EB7t ch\u1EBD \u0111\u1EBFn ch\u01B0\u01A1ng tr\xECnh gi\u1EA3ng d\u1EA1y ch\xEDnh kh\xF3a","C\xF3 t\xEDnh th\u1EDDi s\u1EF1 ho\u1EB7c g\u1EAFn v\u1EDBi v\u1EA5n \u0111\u1EC1 th\u1EF1c t\u1EBF"],constraints:["Ph\u1EA3i n\u1EB1m trong ch\u01B0\u01A1ng tr\xECnh gi\u1EA3ng d\u1EA1y c\u1EE7a c\u1EA5p h\u1ECDc t\u01B0\u01A1ng \u1EE9ng","Kh\xF4ng qu\xE1 10 t\u1EEB"],sample:"H\u1EC7 th\u1ED1ng t\u1EF1 \u0111\u1ED9ng h\xF3a trong n\xF4ng nghi\u1EC7p"},el={guidelines:["Ph\xF9 h\u1EE3p v\u1EDBi \u0111\u1ED9 tu\u1ED5i v\xE0 kh\u1EA3 n\u0103ng t\u1EADp trung c\u1EE7a h\u1ECDc sinh","\u0110\u1EE7 th\u1EDDi gian \u0111\u1EC3 ho\xE0n th\xE0nh c\xE1c ho\u1EA1t \u0111\u1ED9ng ch\xEDnh c\u1EE7a b\xE0i h\u1ECDc"],constraints:["T\u1EEB 45 \u0111\u1EBFn 180 ph\xFAt cho m\u1ED9t bu\u1ED5i h\u1ECDc","T\u1ED5ng th\u1EDDi gian d\u1EF1 \xE1n kh\xF4ng qu\xE1 720 ph\xFAt (12 gi\u1EDD)"],sample:"90 ph\xFAt"},tl={guidelines:["Ph\u1EA3i t\u01B0\u01A1ng th\xEDch v\u1EDBi lessonGrade v\xE0 ph\xF9 h\u1EE3p v\u1EDBi n\u1ED9i dung b\xE0i h\u1ECDc"],constraints:["Ch\u1EC9 ch\u1ECDn m\u1ED9t trong c\xE1c m\u1EE9c: C\u01A1 b\u1EA3n, Trung c\u1EA5p, N\xE2ng cao"],sample:"Trung c\u1EA5p"},nl={guidelines:["Ph\u1EA3i t\u01B0\u01A1ng th\xEDch v\u1EDBi lessonLevel v\xE0 ph\xF9 h\u1EE3p v\u1EDBi n\u1ED9i dung b\xE0i h\u1ECDc"],constraints:["Ch\u1EC9 ch\u1ECDn m\u1ED9t ho\u1EB7c m\u1ED9t kho\u1EA3ng l\u1EDBp t\u1EEB l\u1EDBp 1 \u0111\u1EBFn l\u1EDBp 12"],sample:"L\u1EDBp 8-9"},ll={guidelines:["N\u1EBFu true, c\u1EA7n c\xF3 h\u01B0\u1EDBng d\u1EABn c\u1EE5 th\u1EC3 cho ph\u1EA7n h\u1ECDc tr\u1EF1c tuy\u1EBFn v\xE0 tr\u1EF1c ti\u1EBFp"],constraints:["Gi\xE1 tr\u1ECB boolean: true ho\u1EB7c false"],sample:!0},ol={guidelines:["\u0110\u1EA3m b\u1EA3o c\xE1c c\xF4ng c\u1EE5 d\u1EC5 ti\u1EBFp c\u1EADn v\xE0 ph\xF9 h\u1EE3p v\u1EDBi \u0111i\u1EC1u ki\u1EC7n c\u1EE7a tr\u01B0\u1EDDng h\u1ECDc","N\xEAn c\xF3 ph\u01B0\u01A1ng \xE1n thay th\u1EBF n\u1EBFu kh\xF4ng c\xF3 s\u1EB5n c\xF4ng c\u1EE5"],constraints:["Li\u1EC7t k\xEA t\u1ED1i \u0111a 10 c\xF4ng c\u1EE5","M\u1ED7i c\xF4ng c\u1EE5 kh\xF4ng qu\xE1 50 k\xFD t\u1EF1"],sample:["Arduino Uno","C\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m \u0111\u1EA5t","B\u01A1m n\u01B0\u1EDBc mini","D\xE2y jumper"]},il={guidelines:["\u0110\u1EA3m b\u1EA3o c\xE1c thi\u1EBFt b\u1ECB d\u1EC5 ti\u1EBFp c\u1EADn v\xE0 ph\xF9 h\u1EE3p v\u1EDBi \u0111i\u1EC1u ki\u1EC7n c\u1EE7a tr\u01B0\u1EDDng h\u1ECDc","N\xEAn c\xF3 ph\u01B0\u01A1ng \xE1n thay th\u1EBF n\u1EBFu kh\xF4ng c\xF3 s\u1EB5n thi\u1EBFt b\u1ECB"],constraints:["Li\u1EC7t k\xEA t\u1ED1i \u0111a 5 thi\u1EBFt b\u1ECB","M\u1ED7i thi\u1EBFt b\u1ECB kh\xF4ng qu\xE1 50 k\xFD t\u1EF1"],sample:["M\xE1y t\xEDnh","Smartphone"]},al={guidelines:["Ph\xF9 h\u1EE3p v\u1EDBi tr\xECnh \u0111\u1ED9 c\u1EE7a h\u1ECDc sinh v\xE0 m\u1EE5c ti\xEAu c\u1EE7a b\xE0i h\u1ECDc","N\xEAn c\xE2n nh\u1EAFc s\u1EED d\u1EE5ng ng\xF4n ng\u1EEF l\u1EADp tr\xECnh tr\u1EF1c quan cho h\u1ECDc sinh nh\u1ECF tu\u1ED5i"],constraints:["Ch\u1EC9 ch\u1ECDn m\u1ED9t ng\xF4n ng\u1EEF l\u1EADp tr\xECnh ch\xEDnh","C\xF3 th\u1EC3 th\xEAm t\u1ED1i \u0111a 2 ng\xF4n ng\u1EEF ph\u1EE5"],sample:"Arduino (C++)"},rl={guidelines:["H\u1EA5p d\u1EABn, s\xFAc t\xEDch v\xE0 ph\u1EA3n \xE1nh \u0111\xFAng n\u1ED9i dung b\xE0i h\u1ECDc"],constraints:["\u0110\u1ED9 d\xE0i t\u1EEB 5 \u0111\u1EBFn 15 t\u1EEB","Kh\xF4ng qu\xE1 100 k\xFD t\u1EF1 bao g\u1ED3m c\u1EA3 kho\u1EA3ng tr\u1EAFng"],sample:"X\xE2y d\u1EF1ng V\u01B0\u1EDDn Th\xF4ng Minh: \u1EE8ng d\u1EE5ng IoT trong N\xF4ng nghi\u1EC7p"},sl={guidelines:["M\xF4 t\u1EA3 r\xF5 r\xE0ng c\xE1c k\u1EF9 n\u0103ng STEM s\u1EBD \u0111\u01B0\u1EE3c ph\xE1t tri\u1EC3n"],constraints:["\u0110\u1ED9 d\xE0i t\u1EEB 100 \u0111\u1EBFn 300 t\u1EEB","Ph\u1EA3i \u0111\u1EC1 c\u1EADp \u0111\u1EBFn \xEDt nh\u1EA5t 3 k\u1EF9 n\u0103ng STEM"],sample:"Trong b\xE0i h\u1ECDc n\xE0y, h\u1ECDc sinh s\u1EBD kh\xE1m ph\xE1 c\xE1ch \u1EE9ng d\u1EE5ng c\xF4ng ngh\u1EC7 IoT v\xE0o n\xF4ng nghi\u1EC7p th\xF4ng qua vi\u1EC7c x\xE2y d\u1EF1ng m\u1ED9t h\u1EC7 th\u1ED1ng t\u01B0\u1EDBi c\xE2y t\u1EF1 \u0111\u1ED9ng. H\u1ECDc sinh s\u1EBD ph\xE1t tri\u1EC3n k\u1EF9 n\u0103ng l\u1EADp tr\xECnh v\u1EDBi Arduino, hi\u1EC3u v\u1EC1 c\xE1ch ho\u1EA1t \u0111\u1ED9ng c\u1EE7a c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m, v\xE0 \xE1p d\u1EE5ng ki\u1EBFn th\u1EE9c sinh h\u1ECDc v\u1EC1 nhu c\u1EA7u n\u01B0\u1EDBc c\u1EE7a c\xE2y tr\u1ED3ng. D\u1EF1 \xE1n n\xE0y c\u0169ng gi\xFAp r\xE8n luy\u1EC7n k\u1EF9 n\u0103ng thi\u1EBFt k\u1EBF k\u1EF9 thu\u1EADt v\xE0 gi\u1EA3i quy\u1EBFt v\u1EA5n \u0111\u1EC1 th\u1EF1c t\u1EBF."},cl={guidelines:["Li\u1EC7t k\xEA r\xF5 r\xE0ng c\xE1c t\xEDnh n\u0103ng ch\xEDnh c\u1EE7a d\u1EF1 \xE1n"],constraints:["Li\u1EC7t k\xEA t\u1EEB 3 \u0111\u1EBFn 7 t\xEDnh n\u0103ng","M\u1ED7i t\xEDnh n\u0103ng kh\xF4ng qu\xE1 100 k\xFD t\u1EF1"],sample:["\u0110o \u0111\u1ED9 \u1EA9m \u0111\u1EA5t t\u1EF1 \u0111\u1ED9ng","K\xEDch ho\u1EA1t h\u1EC7 th\u1ED1ng t\u01B0\u1EDBi d\u1EF1a tr\xEAn ng\u01B0\u1EE1ng \u0111\u1ED9 \u1EA9m","Hi\u1EC3n th\u1ECB d\u1EEF li\u1EC7u \u0111\u1ED9 \u1EA9m tr\xEAn LCD","G\u1EEDi th\xF4ng b\xE1o qua \u1EE9ng d\u1EE5ng di \u0111\u1ED9ng"]},ul={guidelines:["H\u01B0\u1EDBng d\u1EABn ng\u1EAFn g\u1ECDn nh\u01B0ng \u0111\u1EA7y \u0111\u1EE7 c\xE1c b\u01B0\u1EDBc th\u1EF1c hi\u1EC7n"],constraints:["T\u1EEB 5 \u0111\u1EBFn 10 b\u01B0\u1EDBc","M\u1ED7i b\u01B0\u1EDBc kh\xF4ng qu\xE1 50 k\xFD t\u1EF1"],sample:["1. K\u1EBFt n\u1ED1i c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m v\u1EDBi Arduino","2. L\u1EADp tr\xECnh \u0111\u1ECDc d\u1EEF li\u1EC7u t\u1EEB c\u1EA3m bi\u1EBFn","3. Thi\u1EBFt l\u1EADp ng\u01B0\u1EE1ng \u0111\u1ED9 \u1EA9m cho vi\u1EC7c t\u01B0\u1EDBi","4. K\u1EBFt n\u1ED1i v\xE0 l\u1EADp tr\xECnh \u0111i\u1EC1u khi\u1EC3n b\u01A1m n\u01B0\u1EDBc","5. T\u1EA1o giao di\u1EC7n hi\u1EC3n th\u1ECB tr\xEAn LCD","6. Ki\u1EC3m tra v\xE0 hi\u1EC7u ch\u1EC9nh h\u1EC7 th\u1ED1ng"]},dl={guidelines:["\u0110\u1EC1 xu\u1EA5t c\xE1c \xFD t\u01B0\u1EDFng m\u1EDF r\u1ED9ng ph\xF9 h\u1EE3p v\u1EDBi nhi\u1EC1u tr\xECnh \u0111\u1ED9 kh\xE1c nhau","Khuy\u1EBFn kh\xEDch s\u1EF1 s\xE1ng t\u1EA1o v\xE0 t\u01B0 duy ph\u1EA3n bi\u1EC7n"],constraints:["\u0110\u1EC1 xu\u1EA5t t\u1EEB 2 \u0111\u1EBFn 5 \xFD t\u01B0\u1EDFng m\u1EDF r\u1ED9ng","M\u1ED7i \xFD t\u01B0\u1EDFng kh\xF4ng qu\xE1 200 k\xFD t\u1EF1"],sample:["Th\xEAm c\u1EA3m bi\u1EBFn \xE1nh s\xE1ng \u0111\u1EC3 t\u1ED1i \u01B0u h\xF3a th\u1EDDi gian t\u01B0\u1EDBi","Ph\xE1t tri\u1EC3n \u1EE9ng d\u1EE5ng di \u0111\u1ED9ng \u0111\u1EC3 theo d\xF5i v\xE0 \u0111i\u1EC1u khi\u1EC3n t\u1EEB xa","T\xEDch h\u1EE3p d\u1EF1 b\xE1o th\u1EDDi ti\u1EBFt \u0111\u1EC3 \u0111i\u1EC1u ch\u1EC9nh l\u1ECBch t\u01B0\u1EDBi"]},hl={guidelines:["S\u1EED d\u1EE5ng \u0111\u1ED9ng t\u1EEB h\xE0nh \u0111\u1ED9ng c\u1EE5 th\u1EC3 (v\xED d\u1EE5: thi\u1EBFt k\u1EBF, ph\xE2n t\xEDch, \u0111\xE1nh gi\xE1)","Bao g\u1ED3m c\u1EA3 m\u1EE5c ti\xEAu ki\u1EBFn th\u1EE9c v\xE0 k\u1EF9 n\u0103ng"],constraints:["T\u1EEB 3 \u0111\u1EBFn 7 m\u1EE5c ti\xEAu","M\u1ED7i m\u1EE5c ti\xEAu b\u1EAFt \u0111\u1EA7u b\u1EB1ng m\u1ED9t \u0111\u1ED9ng t\u1EEB h\xE0nh \u0111\u1ED9ng","M\u1ED7i m\u1EE5c ti\xEAu kh\xF4ng qu\xE1 100 k\xFD t\u1EF1"],sample:["Thi\u1EBFt k\u1EBF m\u1ED9t h\u1EC7 th\u1ED1ng t\u01B0\u1EDBi c\xE2y t\u1EF1 \u0111\u1ED9ng s\u1EED d\u1EE5ng Arduino","Ph\xE2n t\xEDch m\u1ED1i quan h\u1EC7 gi\u1EEFa \u0111\u1ED9 \u1EA9m \u0111\u1EA5t v\xE0 nhu c\u1EA7u n\u01B0\u1EDBc c\u1EE7a c\xE2y","L\u1EADp tr\xECnh vi \u0111i\u1EC1u khi\u1EC3n \u0111\u1EC3 \u0111\u1ECDc d\u1EEF li\u1EC7u c\u1EA3m bi\u1EBFn v\xE0 \u0111i\u1EC1u khi\u1EC3n b\u01A1m n\u01B0\u1EDBc","\u0110\xE1nh gi\xE1 hi\u1EC7u qu\u1EA3 c\u1EE7a h\u1EC7 th\u1ED1ng t\u01B0\u1EDBi t\u1EF1 \u0111\u1ED9ng so v\u1EDBi ph\u01B0\u01A1ng ph\xE1p truy\u1EC1n th\u1ED1ng"]},gl={guidelines:["Li\xEAn k\u1EBFt ch\u1EB7t ch\u1EBD v\u1EDBi m\u1EE5c ti\xEAu b\xE0i h\u1ECDc"],constraints:["Li\u1EC7t k\xEA t\u1EEB 3 \u0111\u1EBFn 7 k\u1EF9 n\u0103ng","M\u1ED7i k\u1EF9 n\u0103ng kh\xF4ng qu\xE1 50 k\xFD t\u1EF1"],sample:["L\u1EADp tr\xECnh Arduino","Thi\u1EBFt k\u1EBF m\u1EA1ch \u0111i\u1EC7n","Ph\xE2n t\xEDch d\u1EEF li\u1EC7u","Gi\u1EA3i quy\u1EBFt v\u1EA5n \u0111\u1EC1","T\u01B0 duy h\u1EC7 th\u1ED1ng"]},ml={guidelines:["\u0110\u1EA3m b\u1EA3o ph\xF9 h\u1EE3p v\u1EDBi ti\xEAu chu\u1EA9n gi\xE1o d\u1EE5c qu\u1ED1c gia ho\u1EB7c \u0111\u1ECBa ph\u01B0\u01A1ng"],constraints:["Li\u1EC7t k\xEA t\u1EEB 2 \u0111\u1EBFn 5 ti\xEAu chu\u1EA9n","M\u1ED7i ti\xEAu chu\u1EA9n kh\xF4ng qu\xE1 200 k\xFD t\u1EF1"],sample:["NGSS MS-ETS1-1: X\xE1c \u0111\u1ECBnh ti\xEAu ch\xED v\xE0 r\xE0ng bu\u1ED9c c\u1EE7a m\u1ED9t v\u1EA5n \u0111\u1EC1 thi\u1EBFt k\u1EBF","CCSS.MATH.PRACTICE.MP4: M\xF4 h\xECnh h\xF3a b\u1EB1ng to\xE1n h\u1ECDc","ISTE 1.3d: H\u1ECDc sinh s\u1EED d\u1EE5ng m\xF4 h\xECnh v\xE0 m\xF4 ph\u1ECFng \u0111\u1EC3 kh\xE1m ph\xE1 c\xE1c h\u1EC7 th\u1ED1ng v\xE0 v\u1EA5n \u0111\u1EC1 ph\u1EE9c t\u1EA1p"]},fl={guidelines:["Li\xEAn k\u1EBFt ch\u1EB7t ch\u1EBD v\u1EDBi m\u1EE5c ti\xEAu b\xE0i h\u1ECDc"],constraints:["Li\u1EC7t k\xEA t\u1EEB 5 \u0111\u1EBFn 15 thu\u1EADt ng\u1EEF","M\u1ED7i thu\u1EADt ng\u1EEF kh\xF4ng qu\xE1 50 k\xFD t\u1EF1"],sample:["Arduino","C\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m","IoT (Internet of Things)","Vi \u0111i\u1EC1u khi\u1EC3n","\u0110\u1ED9 \u1EA9m \u0111\u1EA5t","H\u1EC7 th\u1ED1ng t\u01B0\u1EDBi t\u1EF1 \u0111\u1ED9ng","Ng\u01B0\u1EE1ng k\xEDch ho\u1EA1t"]},vl={guidelines:["Cung c\u1EA5p g\u1EE3i \xFD h\u1EEFu \xEDch cho c\u1EA3 gi\xE1o vi\xEAn v\xE0 h\u1ECDc sinh","Bao g\u1ED3m c\u1EA3 c\xE1ch x\u1EED l\xFD c\xE1c t\xECnh hu\u1ED1ng kh\xF3 kh\u0103n c\xF3 th\u1EC3 g\u1EB7p ph\u1EA3i"],constraints:["T\u1EEB 3 \u0111\u1EBFn 7 m\u1EB9o","M\u1ED7i m\u1EB9o kh\xF4ng qu\xE1 200 k\xFD t\u1EF1"],sample:["Ki\u1EC3m tra k\u1EF9 c\xE1c k\u1EBFt n\u1ED1i d\xE2y tr\u01B0\u1EDBc khi c\u1EA5p ngu\u1ED3n cho Arduino","S\u1EED d\u1EE5ng breadboard \u0111\u1EC3 d\u1EC5 d\xE0ng thay \u0111\u1ED5i v\xE0 s\u1EEDa l\u1ED7i m\u1EA1ch","B\u1EAFt \u0111\u1EA7u v\u1EDBi ng\u01B0\u1EE1ng \u0111\u1ED9 \u1EA9m m\u1EB7c \u0111\u1ECBnh v\xE0 \u0111i\u1EC1u ch\u1EC9nh d\u1EF1a tr\xEAn quan s\xE1t th\u1EF1c t\u1EBF","Khuy\u1EBFn kh\xEDch h\u1ECDc sinh ghi ch\xE9p l\u1EA1i qu\xE1 tr\xECnh th\u1EED nghi\u1EC7m v\xE0 k\u1EBFt qu\u1EA3"]},pl={guidelines:["\u0110a d\u1EA1ng v\u1EC1 lo\u1EA1i t\xE0i nguy\xEAn (video, b\xE0i \u0111\u1ECDc, t\xE0i li\u1EC7u th\u1EF1c h\xE0nh)","\u0110\u1EA3m b\u1EA3o t\xEDnh ch\xEDnh x\xE1c v\xE0 c\u1EADp nh\u1EADt c\u1EE7a th\xF4ng tin"],constraints:["T\u1EEB 3 \u0111\u1EBFn 10 t\xE0i nguy\xEAn","M\u1ED7i t\xE0i nguy\xEAn ph\u1EA3i c\xF3 ID, t\xEAn, lo\u1EA1i v\xE0 URL"],sample:[{resourceId:"VID001",resourceName:"H\u01B0\u1EDBng d\u1EABn l\u1EADp tr\xECnh Arduino c\u01A1 b\u1EA3n",resourceType:"Video",resourceUrl:"https://www.youtube.com/watch?v=example1"},{resourceId:"DOC001",resourceName:"T\xE0i li\u1EC7u v\u1EC1 c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m \u0111\u1EA5t",resourceType:"PDF",resourceUrl:"https://example.com/soil-moisture-sensor.pdf"}]},yl={guidelines:["H\xECnh \u1EA3nh ch\u1EA5t l\u01B0\u1EE3ng cao, h\u1EA5p d\u1EABn v\xE0 li\xEAn quan \u0111\u1EBFn n\u1ED9i dung","\u0110\u1EA3m b\u1EA3o kh\xF4ng vi ph\u1EA1m b\u1EA3n quy\u1EC1n"],constraints:["\u0110\u1ECBnh d\u1EA1ng: JPG, PNG ho\u1EB7c GIF","K\xEDch th\u01B0\u1EDBc: T\u1ED1i thi\u1EC3u 800x600 pixels","Dung l\u01B0\u1EE3ng: Kh\xF4ng qu\xE1 2MB"],sample:"https://example.com/images/smart-garden-project.jpg"},bl={guidelines:["H\xECnh \u1EA3nh ch\u1EA5t l\u01B0\u1EE3ng cao, h\u1EA5p d\u1EABn v\xE0 li\xEAn quan \u0111\u1EBFn n\u1ED9i dung","\u0110\u1EA3m b\u1EA3o kh\xF4ng vi ph\u1EA1m b\u1EA3n quy\u1EC1n"],constraints:["\u0110\u1ECBnh d\u1EA1ng: JPG ho\u1EB7c PNG","K\xEDch th\u01B0\u1EDBc: 1280x720 pixels (16:9 ratio)","Dung l\u01B0\u1EE3ng: Kh\xF4ng qu\xE1 1MB"],sample:"https://example.com/images/iot-in-agriculture-cover.jpg"},kl={guidelines:["\u0110\u01B0\u1EDDng link \u0111\u1EBFn th\u01B0 m\u1EE5c d\u1EF1 \xE1n ho\u1EB7c s\u1EA3n ph\u1EA9m tr\u1EF1c tuy\u1EBFn","\u0110\xE2y l\xE0 phi\xEAn b\u1EA3n \u0111\xE3 l\u01B0\u1EE3c b\u1ECF c\xE1c n\u1ED9i dung m\xE0 h\u1ECDc sinh s\u1EBD l\xE0m trong b\xE0i t\u1EEB projectBasicSample.","ProjectBase cung c\u1EA5p c\xE1c t\xE0i nguy\xEAn t\u1ED1i thi\u1EC3u c\u1EA7n thi\u1EBFt \u0111\u1EC3 h\u1ECDc sinh c\xF3 th\u1EC3 d\u1EC5 d\xE0ng b\u1EAFt \u0111\u1EA7u."],constraints:["\u0110\u1ED9 d\xE0i t\u1EEB 200 \u0111\u1EBFn 500 t\u1EEB","Bao g\u1ED3m danh s\xE1ch v\u1EADt li\u1EC7u v\xE0 c\xE1c b\u01B0\u1EDBc c\u01A1 b\u1EA3n"],sample:"D\u1EF1 \xE1n V\u01B0\u1EDDn Th\xF4ng Minh s\u1EED d\u1EE5ng Arduino Uno l\xE0m b\u1ED9 n\xE3o ch\xEDnh. C\xE1c th\xE0nh ph\u1EA7n c\u01A1 b\u1EA3n bao g\u1ED3m c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m \u0111\u1EA5t, b\u01A1m n\u01B0\u1EDBc mini, v\xE0 m\xE0n h\xECnh LCD. B\u1EAFt \u0111\u1EA7u b\u1EB1ng vi\u1EC7c k\u1EBFt n\u1ED1i c\u1EA3m bi\u1EBFn \u0111\u1ED9 \u1EA9m v\u1EDBi Arduino v\xE0 l\u1EADp tr\xECnh \u0111\u1ECDc d\u1EEF li\u1EC7u. Ti\u1EBFp theo, thi\u1EBFt l\u1EADp ng\u01B0\u1EE1ng \u0111\u1ED9 \u1EA9m \u0111\u1EC3 k\xEDch ho\u1EA1t b\u01A1m n\u01B0\u1EDBc. Cu\u1ED1i c\xF9ng, hi\u1EC3n th\u1ECB th\xF4ng tin \u0111\u1ED9 \u1EA9m tr\xEAn m\xE0n h\xECnh LCD."},Sl={guidelines:["S\u1EA3n ph\u1EA9m m\u1EABu c\u01A1 b\u1EA3n n\xEAn \u0111\u01A1n gi\u1EA3n nh\u01B0ng minh h\u1ECDa \u0111\u01B0\u1EE3c c\xE1c kh\xE1i ni\u1EC7m ch\xEDnh \u0111\u01B0\u1EE3c h\u01B0\u1EDBng d\u1EABn trong b\xE0i."],constraints:["\u0110\u01B0\u1EDDng link \u0111\u1EBFn th\u01B0 m\u1EE5c d\u1EF1 \xE1n ho\u1EB7c s\u1EA3n ph\u1EA9m tr\u1EF1c tuy\u1EBFn","Bao g\u1ED3m comments gi\u1EA3i th\xEDch cho c\xE1c ph\u1EA7n quan tr\u1ECDng"],sample:""},Cl=["\u0110\u1EA3m b\u1EA3o r\u1EB1ng t\u1EA5t c\u1EA3 c\xE1c th\xF4ng tin t\u1EA1o th\xE0nh m\u1ED9t b\xE0i h\u1ECDc STEM nh\u1EA5t qu\xE1n, h\u1EA5p d\u1EABn v\xE0 hi\u1EC7u qu\u1EA3","Th\xFAc \u0111\u1EA9y t\u01B0 duy ph\u1EA3n bi\u1EC7n, s\xE1ng t\u1EA1o v\xE0 k\u1EF9 n\u0103ng gi\u1EA3i quy\u1EBFt v\u1EA5n \u0111\u1EC1 c\u1EE7a h\u1ECDc sinh"];var Ze={lessonProject:Xn,projectName:Wn,projectDescription:Yn,lessonTopic:Zn,lessonDuration:el,lessonLevel:tl,lessonGrade:nl,lessonSuitableForHybridTeaching:ll,lessonTools:ol,devices:il,programmingLanguage:al,lessonTitle:rl,lessonDescription:sl,projectFeatures:cl,projectShortInstruction:ul,projectExtend:dl,lessonObjectives:hl,objRelatedSkill:gl,objRelatedStandard:ml,objRelatedGlossaries:fl,lessonTips:vl,lessonResources:pl,projectImage:yl,lessonCoverImage:bl,projectBase:kl,projectBasicSample:Sl,generalGuidelines:Cl};const Tl={name:"EditableObject",directives:{longPress:xn},props:{initialObject:{type:Object,required:!0}},emits:["update:object"],components:{AssistantAI:Pn,EditableList:bt,GlossaryItem:wt},setup(e,{emit:n}){const l=_t(),t=L(JSON.parse(JSON.stringify(e.initialObject))),d=L(30),h=L(null),c=L(!1),v=L([]),m=L(null),f=L(!1),i=L(""),x=L([]),p=L(Mn.lessonTools),b=L(zn.lessonSkills),T=L(Kn.devices),P=L(!1),M=L(!1),F=L(!1),R=L(!1),le=L(null),se=L("vi"),B=L(null),O=a=>["objRelatedGlossaries","objRelatedStandard","objRelatedSkill"].includes(a),E=w(()=>M.value&&B.value!==null),U=()=>{R.value=!R.value},J=w(()=>B.value&&Ze[B.value.key]),X=a=>{h.value=a.key,B.value=a,console.log("Node m\u1EDBi \u0111\u01B0\u1EE3c ch\u1ECDn:",a),Ze[a.key]?le.value=Ze[a.key]:le.value=null},W=a=>{M.value=a,F.value&&!a&&(M.value=!1),Be(()=>{console.log("DOM \u0111\xE3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt")})},Q=(a,k,G)=>{if(a===""){k(()=>{x.value=de(B.value.key)});return}k(()=>{const D=a.toLowerCase();x.value=de(B.value.key).filter($=>$.label.toLowerCase().indexOf(D)>-1)})},q=a=>typeof a=="object"&&a!==null&&!(Array.isArray(a)&&a.every(k=>typeof k!="object")),A=(a,k="")=>Object.entries(a).map(([G,D])=>{const $=k?`${k}.${G}`:G,H={label:j(G),key:$,value:D,icon:o(D),children:q(D)?A(D,$):null,handler:()=>X(H)};return H}),oe=w(()=>A(t.value)),ie=w(()=>m.value?A(m.value.value,m.value.key):oe.value),de=a=>{if(console.log("Getting options for:",a),Ye.dropdownFields.includes(a))switch(a){case"lessonDuration":return Array.isArray(vt.lessonDurations)?vt.lessonDurations:[];case"lessonLevel":return Array.isArray(pt.lessonLevels)?pt.lessonLevels:[];case"lessonGrade":return Array.isArray(yt.value)?yt.value:[];case"lessonSuitableForHybridTeaching":return Array.isArray(We.lessonSuitableForHybridTeaching)?We.lessonSuitableForHybridTeaching:[];default:return[]}else if(Ye.arrayFields.dropdownArrayFields.includes(a))switch(a){case"lessonTools":return Array.isArray(p.value)?p.value:[];case"devices":return Array.isArray(T.value)?T.value:[];case"lessonSkills":return Array.isArray(b.value)?b.value:[];default:return[]}return[]},ce=a=>{switch(a){case"lessonTools":return p.value.map(k=>k.label);case"devices":return T.value.map(k=>k.label);case"lessonSkills":return b.value.map(k=>k.label);default:return[]}},Y=a=>{if(console.log("Gi\xE1 tr\u1ECB node ban \u0111\u1EA7u:",Ae(a)),!Array.isArray(a.value)){console.error("node.value kh\xF4ng ph\u1EA3i l\xE0 m\u1EA3ng");return}let k;if(a.value.length>0){const D=Ae(a.value[a.value.length-1]);k=JSON.parse(JSON.stringify(D));const $=H=>{for(let ae in H)typeof H[ae]=="string"?H[ae]="":typeof H[ae]=="number"?H[ae]=0:typeof H[ae]=="boolean"?H[ae]=!1:Array.isArray(H[ae])?H[ae]=H[ae].map(He=>typeof He=="object"&&He!==null?$({...He}):""):typeof H[ae]=="object"&&H[ae]!==null&&(H[ae]=$({...H[ae]}));return H};k=$(k)}else k={};const G=Tt(k);a.value.push(G),console.log("M\u1EA3ng sau khi th\xEAm:",Ae(a.value)),Be(()=>{console.log("M\u1EA3ng sau nextTick:",Ae(a.value))}),n("update:modelValue",a.value)},me=a=>{if(B.value!==a){B.value=a,ue(B.value);const k=B.value.key.split(".");let G=t.value;for(let D=0;D<k.length-1;D++)G=G[k[D]];G[k[k.length-1]]=a,n("update:object",JSON.parse(JSON.stringify(t.value)))}},ue=a=>{const k=a.key.split(".");let G=t.value;for(let D=0;D<k.length-1;D++)G=G[k[D]];G[k[k.length-1]]=a.value,n("update:object",JSON.parse(JSON.stringify(t.value)))},u=a=>{if(Array.isArray(a.value)){if(a.value.length>0&&typeof a.value[0]=="object"){const k={};Object.keys(a.value[0]).forEach(G=>{k[G]=""}),a.value.push(k)}else a.value.push("");ue(a)}},g=(a,k)=>{Array.isArray(a.value)&&(a.value.splice(k,1),ue(a))},s=()=>{n("update:object",JSON.parse(JSON.stringify(t.value)))},j=a=>typeof a!="string"?String(a):a.split(/(?=[A-Z])/).map(k=>k.charAt(0).toUpperCase()+k.slice(1)).join(" "),o=a=>typeof a=="string"?"mdi-text":Array.isArray(a)?"mdi-format-list-bulleted":typeof a=="object"&&a!==null?"mdi-folder":"mdi-help-circle",r=(a,k)=>{if(JSON.stringify(a.value)!==JSON.stringify(k)){const G=[...k];a.value=G;const D=a.key.split(".");let $=t.value;for(let H=0;H<D.length-1;H++)$=$[D[H]];$[D[D.length-1]]=G,n("update:object",JSON.parse(JSON.stringify(t.value)))}},S=a=>{if(a&&a.key){const k=a.key.split(".");let G=t.value;for(let D=0;D<k.length-1;D++)G=G[k[D]];G[k[k.length-1]]=a.value,n("update:object",JSON.parse(JSON.stringify(t.value)))}},K=a=>{m.value&&m.value.key===a.key?(m.value=null,v.value=[]):(m.value=a,v.value=[a.key],h.value=null)},z=a=>{v.value=a},Te=()=>{m.value=null,v.value=[]},be=()=>{const a=document.createElement("input");a.type="file",a.accept=".json",a.onchange=k=>{const G=k.target.files[0],D=new FileReader;D.onload=$=>{try{const H=JSON.parse($.target.result);t.value=H,l.notify({color:"positive",message:"JSON \u0111\xE3 \u0111\u01B0\u1EE3c import th\xE0nh c\xF4ng"})}catch{l.notify({color:"negative",message:"L\u1ED7i: File JSON kh\xF4ng h\u1EE3p l\u1EC7"})}},D.readAsText(G)},a.click()},Oe=()=>{f.value=!0},xe=()=>{try{const a=JSON.parse(i.value);t.value=a,f.value=!1,l.notify({color:"positive",message:"JSON \u0111\xE3 \u0111\u01B0\u1EE3c import th\xE0nh c\xF4ng"})}catch{l.notify({color:"negative",message:"L\u1ED7i: JSON kh\xF4ng h\u1EE3p l\u1EC7"})}},Ne=()=>{const a=JSON.stringify(t.value,null,2),k=new Blob([a],{type:"application/json"}),G=URL.createObjectURL(k),D=document.createElement("a");D.href=G,D.download="exported_data.json",D.click(),URL.revokeObjectURL(G)},fe=a=>{P.value=a},V=a=>{B.value=a,ue(a)};return re(M,a=>{console.log("Tr\u1EA1ng th\xE1i AI Assistant \u0111\xE3 thay \u0111\u1ED5i:",a)}),re(h,()=>{F.value&&(M.value=!1)}),re(()=>e.initialObject,a=>{t.value=JSON.parse(JSON.stringify(a))},{deep:!0}),re(h,a=>{if(a){const k=(G,D)=>{for(const $ of G){if($.key===D)return $;if($.children){const H=k($.children,D);if(H)return H}}return null};B.value=k(oe.value,a)}else B.value=null}),{objectData:t,mainSplitterModel:d,selected:h,selectedNode:B,toolOptions:p,skillOptions:b,deviceOptions:T,treeNodes:oe,displayedNodes:ie,getSuggestionsForField:ce,updateObject:ue,addArrayItem:u,removeArrayItem:g,saveChanges:s,updateArrayField:r,useTextEditor:c,formatLabel:j,expandedKeys:v,handleLongPress:K,handleExpanded:z,updateObjectFromAI:S,EditableList:bt,backToFullTree:Te,rootNode:m,fieldTypes:Ye,addObjectArrayItem:Y,manualPasteDialog:f,manualPasteContent:i,importJSON:be,showManualPasteDialog:Oe,updateDropdownValue:me,confirmManualPaste:xe,exportJSON:Ne,handleLoading:fe,updateSelectedNode:V,isAILoading:P,handleAIAssistantToggle:W,useAIAssistant:M,autoDisableAI:F,showAssistantAI:E,handleNodeClick:X,getOptionsForField:de,lessonSuitableForHybridTeaching:We,filterDropdownOptions:Q,dropdownOptions:x,showGuideline:R,currentGuideline:le,toggleGuideline:U,hasGuideline:J,isGlossaryField:O,currentLang:se}}},xl={class:"editable-object-component"},Nl={class:"q-pa-md"},wl=["onClick"],_l={class:"q-pa-md"},ql={key:0},Ol={class:"text-h4 q-mb-md"},Al={class:"row items-center q-mb-md"},jl={key:0},Ll={key:1},Pl={key:2},Fl={key:3},Dl={key:0},El={key:1},Il={key:2},Bl={key:0},Vl={key:1},Gl={key:4},Ml={class:"q-ma-none"},Ul={key:0,class:"q-mb-sm"},zl={class:"q-ma-none q-pl-md"},Hl={key:1,class:"q-mb-sm"},Kl={class:"q-ma-none q-pl-md"},Rl={key:2},Jl={class:"sample-code q-ma-none"};function Ql(e,n,l,t,d,h){const c=_e("EditableList"),v=_e("GlossaryItem"),m=_e("AssistantAI"),f=Ut("long-press");return C(),I("div",xl,[y(un,{modelValue:t.mainSplitterModel,"onUpdate:modelValue":n[16]||(n[16]=i=>t.mainSplitterModel=i),style:{height:"780px"}},{before:N(()=>[Z("div",Nl,[t.rootNode?(C(),te(ee,{key:0,flat:"",label:"Quay l\u1EA1i",icon:"arrow_back",onClick:t.backToFullTree,class:"q-mb-md"},null,8,["onClick"])):ne("",!0),y(mn,{nodes:t.displayedNodes,"node-key":"key","selected-color":"primary",selected:t.selected,"onUpdate:selected":n[0]||(n[0]=i=>t.selected=i),expanded:t.expandedKeys,"onUpdate:expanded":[n[1]||(n[1]=i=>t.expandedKeys=i),t.handleExpanded]},{"default-header":N(i=>[Ge((C(),I("div",{class:"row items-center",onClick:zt(x=>i.node.handler&&i.node.handler(),["stop"])},[y(qe,{name:i.node.icon,color:"primary",size:"28px",class:"q-mr-sm"},null,8,["name"]),Z("div",null,ke(i.node.label),1)],8,wl)),[[f,()=>t.handleLongPress(i.node)]])]),_:1},8,["nodes","selected","expanded","onUpdate:expanded"])])]),after:N(()=>[Z("div",_l,[t.selectedNode?(C(),I("div",ql,[Z("div",Ol,ke(t.selectedNode.label),1),Z("div",Al,[y(Ke,{modelValue:t.useAIAssistant,"onUpdate:modelValue":[n[2]||(n[2]=i=>t.useAIAssistant=i),t.handleAIAssistantToggle],label:"S\u1EED d\u1EE5ng tr\u1EE3 gi\xFAp AI",class:"q-mr-sm"},null,8,["modelValue","onUpdate:modelValue"]),y(Ke,{modelValue:t.autoDisableAI,"onUpdate:modelValue":n[3]||(n[3]=i=>t.autoDisableAI=i),label:"T\u1EF1 \u0111\u1ED9ng t\u1EAFt AI khi chuy\u1EC3n m\u1EE5c",class:"q-mr-sm"},null,8,["modelValue"]),t.isAILoading?(C(),te(st,{key:0,color:"primary",size:"1em"})):ne("",!0)]),typeof t.selectedNode.value=="string"&&!t.fieldTypes.dropdownFields.includes(t.selectedNode.key)?(C(),I("div",jl,[y(Ke,{modelValue:t.useTextEditor,"onUpdate:modelValue":n[4]||(n[4]=i=>t.useTextEditor=i),label:"S\u1EED d\u1EE5ng tr\xECnh so\u1EA1n th\u1EA3o v\u0103n b\u1EA3n"},null,8,["modelValue"]),t.useTextEditor?(C(),te(Tn,{key:1,modelValue:t.selectedNode.value,"onUpdate:modelValue":n[7]||(n[7]=i=>t.selectedNode.value=i),"min-height":"5rem",onBlur:n[8]||(n[8]=i=>t.updateObject(t.selectedNode))},null,8,["modelValue"])):(C(),te(ye,{key:0,modelValue:t.selectedNode.value,"onUpdate:modelValue":n[5]||(n[5]=i=>t.selectedNode.value=i),filled:"",type:"textarea",autogrow:"",onBlur:n[6]||(n[6]=i=>t.updateObject(t.selectedNode))},null,8,["modelValue"]))])):typeof t.selectedNode.value=="number"&&t.selectedNode.key!=="lessonDuration"?(C(),I("div",Ll,[y(ye,{modelValue:t.selectedNode.value,"onUpdate:modelValue":n[9]||(n[9]=i=>t.selectedNode.value=i),type:"number",onBlur:n[10]||(n[10]=i=>t.updateObject(t.selectedNode))},null,8,["modelValue"])])):t.fieldTypes.dropdownFields.includes(t.selectedNode.key)?(C(),I("div",Pl,[y(Nt,{modelValue:t.selectedNode.value,"onUpdate:modelValue":[n[11]||(n[11]=i=>t.selectedNode.value=i),t.updateDropdownValue],options:t.dropdownOptions,"option-value":"value","option-label":"label","emit-value":"","map-options":"","use-input":"","fill-input":"","hide-selected":"","input-debounce":"0",onFilter:t.filterDropdownOptions},{"no-option":N(()=>[y(Se,null,{default:N(()=>[y(he,{class:"text-grey"},{default:N(()=>n[20]||(n[20]=[Ce(" Kh\xF4ng t\xECm th\u1EA5y k\u1EBFt qu\u1EA3 ")])),_:1})]),_:1})]),_:1},8,["modelValue","options","onUpdate:modelValue","onFilter"])])):Array.isArray(t.selectedNode.value)?(C(),I("div",Fl,[t.selectedNode.value.every(i=>typeof i=="string")?(C(),I("div",Dl,[y(c,{"initial-items":t.selectedNode.value,"add-button-label":"Th\xEAm m\u1EE5c","is-dropdown":t.fieldTypes.arrayFields.dropdownArrayFields.includes(t.selectedNode.key),"field-name":t.selectedNode.key,suggestions:t.getOptionsForField(t.selectedNode.key),"onUpdate:items":n[12]||(n[12]=i=>t.updateArrayField(t.selectedNode,i))},null,8,["initial-items","is-dropdown","field-name","suggestions"])])):t.selectedNode.key.includes("obj")||t.selectedNode.key.includes("devices")||t.selectedNode.key.includes("lessonTools")?(C(),I("div",El,[(C(!0),I(ve,null,pe(t.selectedNode.value,(i,x)=>(C(),te(Se,{key:x,class:"q-pa-none q-ma-none"},{default:N(()=>[y(he,{side:""},{default:N(()=>[(C(),te(v,{key:x,term:i,currentLang:"vi",displayMode:"list","onUpdate:item":p=>e.updateGlossaryItem(t.selectedNode,x,p)},null,8,["term","onUpdate:item"]))]),_:2},1024),y(he,{side:""},{default:N(()=>[y(ee,{flat:"",round:"",color:"negative",icon:"delete",onClick:p=>t.removeArrayItem(t.selectedNode,x)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))])):(C(),I("div",Il,[y(ct,{bordered:"",separator:""},{default:N(()=>[(C(!0),I(ve,null,pe(t.selectedNode.value,(i,x)=>(C(),te(Se,{key:x},{default:N(()=>[y(he,null,{default:N(()=>[typeof i=="string"?(C(),I("div",Bl,[y(ye,{modelValue:t.selectedNode.value[x],"onUpdate:modelValue":p=>t.selectedNode.value[x]=p,dense:"",filled:"",type:"textarea",autogrow:"",onBlur:n[13]||(n[13]=p=>t.updateObject(t.selectedNode))},null,8,["modelValue","onUpdate:modelValue"])])):typeof i=="object"?(C(),I("div",Vl,[(C(!0),I(ve,null,pe(i,(p,b)=>(C(),I("div",{key:b},[y(ye,{label:t.formatLabel(b),modelValue:i[b],"onUpdate:modelValue":T=>i[b]=T,dense:"",filled:"",onBlur:n[14]||(n[14]=T=>t.updateObject(t.selectedNode))},null,8,["label","modelValue","onUpdate:modelValue"])]))),128))])):ne("",!0)]),_:2},1024),y(he,{side:""},{default:N(()=>[y(ee,{flat:"",round:"",color:"negative",icon:"delete",onClick:p=>t.removeArrayItem(t.selectedNode,x)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1}),y(ee,{label:"Th\xEAm m\u1EE5c",color:"primary",class:"q-mb-md",size:"md",onClick:n[15]||(n[15]=i=>t.addObjectArrayItem(t.selectedNode))})]))])):ne("",!0),t.showAssistantAI?(C(),I("div",Gl,[y(m,{selectedNode:t.selectedNode,fullObject:t.objectData,addObjectArrayItem:t.addArrayItem,onLoading:t.handleLoading,"onUpdate:object":t.updateObjectFromAI,"onUpdate:selectedNode":t.updateSelectedNode},null,8,["selectedNode","fullObject","addObjectArrayItem","onLoading","onUpdate:object","onUpdate:selectedNode"])])):ne("",!0)])):ne("",!0)])]),_:1},8,["modelValue"]),y(nt,{modelValue:t.manualPasteDialog,"onUpdate:modelValue":n[18]||(n[18]=i=>t.manualPasteDialog=i)},{default:N(()=>[y(Me,{style:{"min-width":"350px"}},{default:N(()=>[y(ge,null,{default:N(()=>n[21]||(n[21]=[Z("div",{class:"text-h6"},"Nh\u1EADp JSON",-1)])),_:1}),y(ge,{class:"q-pt-none"},{default:N(()=>[y(ye,{modelValue:t.manualPasteContent,"onUpdate:modelValue":n[17]||(n[17]=i=>t.manualPasteContent=i),type:"textarea",filled:"",autogrow:""},null,8,["modelValue"])]),_:1}),y(Ct,{align:"right"},{default:N(()=>[Ge(y(ee,{flat:"",label:"H\u1EE7y",color:"primary"},null,512),[[xt]]),y(ee,{flat:"",label:"X\xE1c nh\u1EADn",color:"primary",onClick:t.confirmManualPaste},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t.hasGuideline?(C(),te(ee,{key:0,icon:"help",color:"orange",round:"",size:"lg",class:"fixed-bottom-right",onClick:t.toggleGuideline},{default:N(()=>[y(Ue,null,{default:N(()=>n[22]||(n[22]=[Ce("H\u01B0\u1EDBng d\u1EABn")])),_:1})]),_:1},8,["onClick"])):ne("",!0),y(nt,{modelValue:t.showGuideline,"onUpdate:modelValue":n[19]||(n[19]=i=>t.showGuideline=i)},{default:N(()=>[y(Me,{style:{width:"700px","max-width":"80vw"},class:"q-pa-lg"},{default:N(()=>[y(ge,{class:"q-pa-sm"},{default:N(()=>[Z("h5",Ml,"H\u01B0\u1EDBng d\u1EABn cho "+ke(t.selectedNode.label),1)]),_:1}),t.currentGuideline?(C(),te(ge,{key:0,class:"q-pa-sm"},{default:N(()=>[t.currentGuideline.guidelines?(C(),I("div",Ul,[n[23]||(n[23]=Z("h6",{class:"q-ma-none q-mb-xs"},"H\u01B0\u1EDBng d\u1EABn",-1)),Z("ul",zl,[(C(!0),I(ve,null,pe(t.currentGuideline.guidelines,(i,x)=>(C(),I("li",{key:x,class:"q-mb-xs"},ke(i),1))),128))])])):ne("",!0),t.currentGuideline.constraints?(C(),I("div",Hl,[n[24]||(n[24]=Z("h6",{class:"q-ma-none q-mb-xs"},"R\xE0ng bu\u1ED9c",-1)),Z("ul",Kl,[(C(!0),I(ve,null,pe(t.currentGuideline.constraints,(i,x)=>(C(),I("li",{key:x,class:"q-mb-xs"},ke(i),1))),128))])])):ne("",!0),t.currentGuideline.sample?(C(),I("div",Rl,[n[25]||(n[25]=Z("h6",{class:"q-ma-none q-mb-xs"},"M\u1EABu",-1)),Z("pre",Jl,ke(t.currentGuideline.sample),1)])):ne("",!0)]),_:1})):ne("",!0)]),_:1})]),_:1},8,["modelValue"])])}var $l=ze(Tl,[["render",Ql],["__scopeId","data-v-4b07e64b"]]);function Ie(e,n){return[!0,!1].includes(e)?e:n}var To=lt({name:"QPagination",props:{...ot,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>(typeof e=="string"?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>e===""||Ht.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:n}){const{proxy:l}=at(),{$q:t}=l,d=it(e,t),h=w(()=>parseInt(e.min,10)),c=w(()=>parseInt(e.max,10)),v=w(()=>parseInt(e.maxPages,10)),m=w(()=>T.value+" / "+c.value),f=w(()=>Ie(e.boundaryLinks,e.input)),i=w(()=>Ie(e.boundaryNumbers,!e.input)),x=w(()=>Ie(e.directionLinks,e.input)),p=w(()=>Ie(e.ellipses,!e.input)),b=L(null),T=w({get:()=>e.modelValue,set:q=>{if(q=parseInt(q,10),e.disable||isNaN(q))return;const A=Zt(q,h.value,c.value);e.modelValue!==A&&n("update:modelValue",A)}});re(()=>`${h.value}|${c.value}`,()=>{T.value=e.modelValue});const P=w(()=>"q-pagination row no-wrap items-center"+(e.disable===!0?" disabled":"")),M=w(()=>e.gutter in gt?`${gt[e.gutter]}px`:e.gutter||null),F=w(()=>M.value!==null?`--q-pagination-gutter-parent:-${M.value};--q-pagination-gutter-child:${M.value}`:null),R=w(()=>{const q=[e.iconFirst||t.iconSet.pagination.first,e.iconPrev||t.iconSet.pagination.prev,e.iconNext||t.iconSet.pagination.next,e.iconLast||t.iconSet.pagination.last];return t.lang.rtl===!0?q.reverse():q}),le=w(()=>({"aria-disabled":e.disable===!0?"true":"false",role:"navigation"})),se=w(()=>Kt(e,"flat")),B=w(()=>({[se.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:e.ripple!==null?e.ripple:!0})),O=w(()=>{const q={[se.value]:!1};return e.activeDesign!==""&&(q[e.activeDesign]=!0),q}),E=w(()=>({...O.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor})),U=w(()=>{let q=Math.max(v.value,1+(p.value?2:0)+(i.value?2:0));const A={pgFrom:h.value,pgTo:c.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(c.value).length)}em`}};return v.value&&q<c.value-h.value+1&&(q=1+Math.floor(q/2)*2,A.pgFrom=Math.max(h.value,Math.min(c.value-q+1,e.modelValue-Math.floor(q/2))),A.pgTo=Math.min(c.value,A.pgFrom+q-1),i.value&&(A.boundaryStart=!0,A.pgFrom++),p.value&&A.pgFrom>h.value+(i.value?1:0)&&(A.ellipsesStart=!0,A.pgFrom++),i.value&&(A.boundaryEnd=!0,A.pgTo--),p.value&&A.pgTo<c.value-(i.value?1:0)&&(A.ellipsesEnd=!0,A.pgTo--)),A});function J(q){T.value=q}function X(q){T.value=T.value+q}const W=w(()=>{function q(){T.value=b.value,b.value=null}return{"onUpdate:modelValue":A=>{b.value=A},onKeyup:A=>{Rt(A,13)===!0&&q()},onBlur:q}});function Q(q,A,oe){const ie={"aria-label":A,"aria-current":"false",...B.value,...q};return oe===!0&&Object.assign(ie,{"aria-current":"true",...E.value}),A!==void 0&&(e.toFn!==void 0?ie.to=e.toFn(A):ie.onClick=()=>{J(A)}),_(ee,ie)}return Object.assign(l,{set:J,setByOffset:X}),()=>{const q=[],A=[];let oe;if(f.value===!0&&(q.push(Q({key:"bls",disable:e.disable||e.modelValue<=h.value,icon:R.value[0],"aria-label":t.lang.pagination.first},h.value)),A.unshift(Q({key:"ble",disable:e.disable||e.modelValue>=c.value,icon:R.value[3],"aria-label":t.lang.pagination.last},c.value))),x.value===!0&&(q.push(Q({key:"bdp",disable:e.disable||e.modelValue<=h.value,icon:R.value[1],"aria-label":t.lang.pagination.prev},e.modelValue-1)),A.unshift(Q({key:"bdn",disable:e.disable||e.modelValue>=c.value,icon:R.value[2],"aria-label":t.lang.pagination.next},e.modelValue+1))),e.input!==!0){oe=[];const{pgFrom:ie,pgTo:de,marginalStyle:ce}=U.value;if(U.value.boundaryStart===!0){const Y=h.value===e.modelValue;q.push(Q({key:"bns",style:ce,disable:e.disable,label:h.value},h.value,Y))}if(U.value.boundaryEnd===!0){const Y=c.value===e.modelValue;A.unshift(Q({key:"bne",style:ce,disable:e.disable,label:c.value},c.value,Y))}U.value.ellipsesStart===!0&&q.push(Q({key:"bes",style:ce,disable:e.disable,label:"\u2026",ripple:!1},ie-1)),U.value.ellipsesEnd===!0&&A.unshift(Q({key:"bee",style:ce,disable:e.disable,label:"\u2026",ripple:!1},de+1));for(let Y=ie;Y<=de;Y++)oe.push(Q({key:`bpg${Y}`,style:ce,disable:e.disable,label:Y},Y,Y===e.modelValue))}return _("div",{class:P.value,...le.value},[_("div",{class:"q-pagination__content row no-wrap items-center",style:F.value},[...q,e.input===!0?_(ye,{class:"inline",style:{width:`${m.value.length/1.5}em`},type:"number",dense:!0,value:b.value,disable:e.disable,dark:d.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:m.value,min:h.value,max:c.value,...W.value}):_("div",{class:"q-pagination__middle row justify-center"},oe),...A])])}}}),xo=Jt({name:"touch-hold",beforeMount(e,n){const{modifiers:l}=n;if(l.mouse!==!0&&Re.has.touch!==!0)return;const t={handler:n.value,noop:St,mouseStart(h){typeof t.handler=="function"&&Qt(h)===!0&&(je(t,"temp",[[document,"mousemove","move","passiveCapture"],[document,"click","end","notPassiveCapture"]]),t.start(h,!0))},touchStart(h){if(h.target!==void 0&&typeof t.handler=="function"){const c=h.target;je(t,"temp",[[c,"touchmove","move","passiveCapture"],[c,"touchcancel","end","notPassiveCapture"],[c,"touchend","end","notPassiveCapture"]]),t.start(h)}},start(h,c){t.origin=mt(h);const v=Date.now();Re.is.mobile===!0&&(document.body.classList.add("non-selectable"),Qe(),t.styleCleanup=m=>{t.styleCleanup=void 0;const f=()=>{document.body.classList.remove("non-selectable")};m===!0?(Qe(),setTimeout(f,10)):f()}),t.triggered=!1,t.sensitivity=c===!0?t.mouseSensitivity:t.touchSensitivity,t.timer=setTimeout(()=>{t.timer=void 0,Qe(),t.triggered=!0,t.handler({evt:h,touch:c!==!0,mouse:c===!0,position:t.origin,duration:Date.now()-v})},t.duration)},move(h){const{top:c,left:v}=mt(h);t.timer!==void 0&&(Math.abs(v-t.origin.left)>=t.sensitivity||Math.abs(c-t.origin.top)>=t.sensitivity)&&(clearTimeout(t.timer),t.timer=void 0)},end(h){var c;Je(t,"temp"),(c=t.styleCleanup)==null||c.call(t,t.triggered),t.triggered===!0?h!==void 0&&Ve(h):t.timer!==void 0&&(clearTimeout(t.timer),t.timer=void 0)}},d=[600,5,7];if(typeof n.arg=="string"&&n.arg.length!==0&&n.arg.split(":").forEach((h,c)=>{const v=parseInt(h,10);v&&(d[c]=v)}),[t.duration,t.touchSensitivity,t.mouseSensitivity]=d,e.__qtouchhold=t,l.mouse===!0){const h=l.mouseCapture===!0||l.mousecapture===!0?"Capture":"";je(t,"main",[[e,"mousedown","mouseStart",`passive${h}`]])}Re.has.touch===!0&&je(t,"main",[[e,"touchstart","touchStart",`passive${l.capture===!0?"Capture":""}`],[e,"touchend","noop","notPassiveCapture"]])},updated(e,n){const l=e.__qtouchhold;l!==void 0&&n.oldValue!==n.value&&(typeof n.value!="function"&&l.end(),l.handler=n.value)},beforeUnmount(e){var l;const n=e.__qtouchhold;n!==void 0&&(Je(n,"main"),Je(n,"temp"),n.timer!==void 0&&clearTimeout(n.timer),(l=n.styleCleanup)==null||l.call(n),delete e.__qtouchhold)}});const et="glossaryDocumentsCache",kt="glossaryCategoriesCache",Xl="glossaryTermsCache",Wl=5*60*1e3;function tt(e,n){const l={data:n,timestamp:Date.now()};localStorage.setItem(e,JSON.stringify(l))}function we(e){const n=localStorage.getItem(e);if(!n)return null;const{data:l,timestamp:t}=JSON.parse(n);return Date.now()-t>Wl?(localStorage.removeItem(e),null):l}const No=$t("glossary",()=>{L("vi");const e=L([]),n=L([]),l=L({}),t=L(!1),d=L(null),h=async()=>{const f=we(et);if(f){n.value=f,console.log("\u0110\xE3 t\u1EA3i documents t\u1EEB cache");return}if(!t.value){t.value=!0,d.value=null;try{const i=await Xt();n.value=i,tt(et,i),console.log("Documents \u0111\xE3 l\u01B0u v\xE0o cache: ",i)}catch(i){console.error("L\u1ED7i khi l\u1EA5y v\xE0 l\u01B0u danh s\xE1ch document:",i),d.value=i.message}finally{t.value=!1}}},c=async f=>{const i=`${kt}_${f}`,x=we(i);if(x)return l.value[f]=x,console.log(`\u0110\xE3 t\u1EA3i categories cho ${f} t\u1EEB cache`),x;if(!t.value){t.value=!0,d.value=null;try{const p=await Wt(f);return l.value[f]=p,tt(i,p),console.log(`Categories \u0111\xE3 l\u01B0u v\xE0o cache cho ${f}:`,p),p}catch(p){console.error(`L\u1ED7i khi l\u1EA5y v\xE0 l\u01B0u danh s\xE1ch category cho ${f}:`,p),d.value=p.message}finally{t.value=!1}}},v=async(f,i)=>{const x=`${Xl}_${f}_${i}`,p=we(x);if(console.log("cachedTerms: ",p),p)return e.value[`${f}_${i}`]=p,console.log(`\u0110\xE3 t\u1EA3i terms cho ${f}/${i} t\u1EEB cache`),p;if(!t.value){t.value=!0,d.value=null;try{const b=await Yt(f,i);return e.value[`${f}_${i}`]=b,tt(x,b),console.log(`Terms \u0111\xE3 l\u01B0u v\xE0o cache cho ${f}/${i}:`,b),b}catch(b){console.error(`L\u1ED7i khi l\u1EA5y v\xE0 l\u01B0u danh s\xE1ch terms cho ${f}/${i}:`,b),d.value=b.message}finally{t.value=!1}}};return(()=>{const f=we(et);f&&(n.value=f,console.log("\u0110\xE3 t\u1EA3i documents t\u1EEB localStorage"));const i=we(kt);i&&(l.value=i,console.log("\u0110\xE3 t\u1EA3i categories t\u1EEB localStorage"))})(),{documents:n,allCategories:l,terms:e,isLoading:t,error:d,fetchAndStoreDocuments:h,fetchAndStoreCategories:c,fetchAndCacheTermsInSubcollection:v}}),Yl="http://json-schema.org/draft-07/schema#",Zl="object",eo={glossary:{type:"array",items:{type:"object",properties:{id:{type:"string",description:"\u0110\u1ECBnh danh duy nh\u1EA5t cho m\u1ED7i m\u1EE5c trong glossary"},vi:{type:"object",properties:{term:{type:"string",description:"Thu\u1EADt ng\u1EEF c\u1EA7n \u0111\u1ECBnh ngh\u0129a (ti\u1EBFng Vi\u1EC7t)"},definition:{type:"string",description:"\u0110\u1ECBnh ngh\u0129a c\u1EE7a thu\u1EADt ng\u1EEF (ti\u1EBFng Vi\u1EC7t)"},category:{type:"string",description:"Danh m\u1EE5c l\u1EDBn c\u1EE7a thu\u1EADt ng\u1EEF (ti\u1EBFng Vi\u1EC7t)"},group:{type:"string",description:"Nh\xF3m nh\u1ECF h\u01A1n c\u1EE7a thu\u1EADt ng\u1EEF, thu\u1ED9c m\u1ED9t category (ti\u1EBFng Vi\u1EC7t)"},examples:{type:"object",properties:{howto:{type:"array",items:{type:"string"},description:"C\xE1c v\xED d\u1EE5 v\u1EC1 c\xE1ch s\u1EED d\u1EE5ng thu\u1EADt ng\u1EEF (ti\u1EBFng Vi\u1EC7t)"},context:{type:"array",items:{type:"string"},description:"C\xE1c ng\u1EEF c\u1EA3nh ho\u1EB7c tr\u01B0\u1EDDng h\u1EE3p s\u1EED d\u1EE5ng thu\u1EADt ng\u1EEF (ti\u1EBFng Vi\u1EC7t)"}},description:"C\xE1c v\xED d\u1EE5 v\xE0 ng\u1EEF c\u1EA3nh s\u1EED d\u1EE5ng thu\u1EADt ng\u1EEF (ti\u1EBFng Vi\u1EC7t)"},field:{type:"string",description:"Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u c\u1EE7a thu\u1EADt ng\u1EEF (ti\u1EBFng Vi\u1EC7t)"}},required:["term","definition"]},en:{type:"object",properties:{term:{type:"string",description:"Thu\u1EADt ng\u1EEF c\u1EA7n \u0111\u1ECBnh ngh\u0129a (ti\u1EBFng Anh)"},definition:{type:"string",description:"\u0110\u1ECBnh ngh\u0129a c\u1EE7a thu\u1EADt ng\u1EEF (ti\u1EBFng Anh)"},category:{type:"string",description:"Danh m\u1EE5c l\u1EDBn c\u1EE7a thu\u1EADt ng\u1EEF (ti\u1EBFng Anh)"},group:{type:"string",description:"Nh\xF3m nh\u1ECF h\u01A1n c\u1EE7a thu\u1EADt ng\u1EEF, thu\u1ED9c m\u1ED9t category (ti\u1EBFng Anh)"},examples:{type:"object",properties:{howto:{type:"array",items:{type:"string"},description:"C\xE1c v\xED d\u1EE5 v\u1EC1 c\xE1ch s\u1EED d\u1EE5ng thu\u1EADt ng\u1EEF (ti\u1EBFng Anh)"},context:{type:"array",items:{type:"string"},description:"C\xE1c ng\u1EEF c\u1EA3nh ho\u1EB7c tr\u01B0\u1EDDng h\u1EE3p s\u1EED d\u1EE5ng thu\u1EADt ng\u1EEF (ti\u1EBFng Anh)"}},description:"C\xE1c v\xED d\u1EE5 v\xE0 ng\u1EEF c\u1EA3nh s\u1EED d\u1EE5ng thu\u1EADt ng\u1EEF (ti\u1EBFng Anh)"},field:{type:"string",description:"Tr\u01B0\u1EDDng d\u1EEF li\u1EC7u c\u1EE7a thu\u1EADt ng\u1EEF (ti\u1EBFng Anh)"}},required:["term","definition"]}},required:["id","vi","en"]}}};var to={$schema:Yl,type:Zl,properties:eo};const no={name:"GlossaryCreator",components:{EditableObject:$l,GlossaryItem:wt},emits:["glossary-updated","update:showGlossaryCreator"],props:{showGlossaryCreator:{type:Boolean,default:!1}},setup(e,{emit:n}){const l=_t(),t=new an,d=L("import"),h=L(null),c=L([]),v=L("vi"),m=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(O){var E=Math.random()*16|0,U=O=="x"?E:E&3|8;return U.toString(16)}),f=Tt({id:"",vi:{term:"",definition:"",category:"",group:"",examples:{howto:[],context:[]},field:""},en:{term:"",definition:"",category:"",group:"",examples:{howto:[],context:[]},field:""}}),i=w({get:()=>e.showGlossaryCreator,set:O=>n("update:showGlossaryCreator",O)}),x=O=>{f.id||(f.id=m()),Object.assign(f,O)},p=()=>{d.value==="create"?P():d.value==="import"&&c.value.length&&M()},b=async()=>{d.value==="create"?await F():d.value==="import"&&c.value.length&&await R()},T=O=>{let E=JSON.parse(localStorage.getItem("localGlossary")||"[]");const U=E.findIndex(J=>J.id===O.id);return U!==-1?E[U]=JSON.parse(JSON.stringify(O)):E.push(JSON.parse(JSON.stringify(O))),localStorage.setItem("localGlossary",JSON.stringify(E)),E},P=()=>{if(!le(f)){l.notify({color:"negative",message:"D\u1EEF li\u1EC7u kh\xF4ng h\u1EE3p l\u1EC7. Vui l\xF2ng ki\u1EC3m tra l\u1EA1i.",icon:"warning"});return}f.id||(f.id=m());const O=T(f);n("glossary-updated",O),l.notify({color:"positive",message:"\u0110\xE3 l\u01B0u thu\u1EADt ng\u1EEF th\xE0nh c\xF4ng!",icon:"check"}),se(),i.value=!1},M=()=>{let O=[];c.value.forEach(E=>{O=T(E)}),n("glossary-updated",O)},F=async()=>{try{const O=JSON.parse(localStorage.getItem("localGlossary")||"[]");for(const E of O){const{id:U,vi:J,en:X}=E,W=Le(Pe,"glossary",J.field||"NoViField",J.category||"NoViCategory",U),Q=Le(Pe,"glossary",X.field||"NoEnField",X.category||"NoEnCategory",U),q=await Fe(W),A=await Fe(Q);q.exists()?await Ee(W,{...E}):await De(W,{...E}),A.exists()?await Ee(Q,{...E}):await De(Q,{...E})}l.notify({color:"positive",message:"C\u1EADp nh\u1EADt Database th\xE0nh c\xF4ng!",icon:"check"})}catch(O){l.notify({color:"negative",message:"L\u1ED7i khi c\u1EADp nh\u1EADt Database: "+O,icon:"error"})}},R=async()=>{try{for(const O of c.value){const{id:E,vi:U,en:J}=O,X=Le(Pe,"glossary",U.field||"NoViField",U.category||"NoViCategory",E),W=Le(Pe,"glossary",J.field||"NoEnField",J.category||"NoEnCategory",E),Q=await Fe(X),q=await Fe(W);Q.exists()?await Ee(X,{...O}):await De(X,{...O}),q.exists()?await Ee(W,{...O}):await De(W,{...O})}l.notify({color:"positive",message:"C\u1EADp nh\u1EADt Database th\xE0nh c\xF4ng!",icon:"check"})}catch(O){l.notify({color:"negative",message:"L\u1ED7i khi c\u1EADp nh\u1EADt Database: "+O,icon:"error"})}},le=O=>t.compile(to)(O),se=()=>{Object.assign(f,{id:m(),vi:{term:"",definition:"",category:"",group:"",examples:{howto:[],context:[]},field:""},en:{term:"",definition:"",category:"",group:"",examples:{howto:[],context:[]},field:""}})};return re(h,()=>{const O=h.value;if(!O)return;const E=new FileReader;O.type==="application/json"?(E.onload=U=>{try{const J=JSON.parse(U.target.result);le(J)?c.value=J.glossary.map(X=>({...X,id:X.id||m()})):l.notify({color:"negative",message:"File JSON kh\xF4ng h\u1EE3p l\u1EC7.",icon:"warning"})}catch(J){l.notify({color:"negative",message:"L\u1ED7i khi \u0111\u1ECDc file JSON: "+J,icon:"error"})}},E.readAsText(O)):O.type==="text/csv"?(E.onload=U=>{l.notify({color:"warning",message:"Ch\u1EE9c n\u0103ng import file CSV ch\u01B0a \u0111\u01B0\u1EE3c h\u1ED7 tr\u1EE3.",icon:"warning"})},E.readAsText(O)):l.notify({color:"negative",message:"File kh\xF4ng h\u1EE3p l\u1EC7. Vui l\xF2ng ch\u1ECDn file CSV ho\u1EB7c JSON.",icon:"warning"})}),{mode:d,uploadedFile:h,importedGlossary:c,currentLang:v,newGlossaryTerm:f,updateNewGlossaryTerm:x,handleSaveLocally:p,handleUpdateDatabase:b,resetGlossaryTerm:se,showGlossaryCreatorProp:i}}};function lo(e,n,l,t,d,h){const c=_e("GlossaryItem"),v=_e("EditableObject");return C(),I("div",null,[y(nt,{modelValue:t.showGlossaryCreatorProp,"onUpdate:modelValue":n[2]||(n[2]=m=>t.showGlossaryCreatorProp=m)},{default:N(()=>[y(Me,{style:{"min-width":"80vw"}},{default:N(()=>[y(ge,null,{default:N(()=>n[3]||(n[3]=[Z("div",{class:"text-h6"},"T\u1EA1o M\u1EDBi Thu\u1EADt Ng\u1EEF",-1)])),_:1}),y(ge,{class:"q-pt-none"},{default:N(()=>[y(en,{modelValue:t.mode,"onUpdate:modelValue":n[0]||(n[0]=m=>t.mode=m),"toggle-color":"primary",options:[{label:"Import Mode",value:"import"},{label:"Create Mode",value:"create"}]},null,8,["modelValue"])]),_:1}),t.mode==="import"?(C(),te(ge,{key:0,class:"q-pt-none"},{default:N(()=>[y(tn,{outlined:"",modelValue:t.uploadedFile,"onUpdate:modelValue":n[1]||(n[1]=m=>t.uploadedFile=m),label:"Ch\u1ECDn file CSV ho\u1EB7c JSON",accept:".csv, .json"},{prepend:N(()=>[y(qe,{name:"upload"})]),_:1},8,["modelValue"]),t.importedGlossary.length?(C(),te(ct,{key:0},{default:N(()=>[y(nn,{header:""},{default:N(()=>n[4]||(n[4]=[Ce("C\xE1c thu\u1EADt ng\u1EEF \u0111\xE3 import:")])),_:1}),(C(!0),I(ve,null,pe(t.importedGlossary,m=>(C(),te(c,{key:m.id,term:m,"current-lang":t.currentLang,"display-mode":"list"},null,8,["term","current-lang"]))),128))]),_:1})):ne("",!0)]),_:1})):ne("",!0),t.mode==="create"?(C(),te(ge,{key:1,class:"q-pt-none"},{default:N(()=>[y(v,{initialObject:t.newGlossaryTerm,"onUpdate:object":t.updateNewGlossaryTerm},null,8,["initialObject","onUpdate:object"])]),_:1})):ne("",!0),y(Ct,{align:"right"},{default:N(()=>[Ge(y(ee,{flat:"",label:"H\u1EE7y",color:"primary"},null,512),[[xt]]),y(ee,{flat:"",label:"L\u01B0u N\u1ED9i B\u1ED9",color:"primary",onClick:t.handleSaveLocally},null,8,["onClick"]),y(ee,{flat:"",label:"C\u1EADp nh\u1EADt Database",color:"primary",onClick:t.handleUpdateDatabase},null,8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}var wo=ze(no,[["render",lo]]);export{$l as E,wo as G,To as Q,xo as T,No as u};
